<html><!-- Mirrored from www.php.net/manual/en/function.shell-exec.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:48:22 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>shell_exec</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.shell-exec.html">
 <link rel="shorturl" href="https://www.php.net/shell-exec">
 <link rel="alternate" href="https://www.php.net/shell-exec" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.exec.html">
 <link rel="prev" href="function.proc-terminate.html">
 <link rel="next" href="function.system.html">

 <link rel="alternate" href="function.shell-exec.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.shell-exec.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.shell-exec.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.shell-exec.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.shell-exec.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.shell-exec.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.shell-exec.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.shell-exec.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.shell-exec.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.shell-exec.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.fileprocess.process.html">Process Control Extensions</a></li>      <li><a href="book.exec.html">Program execution</a></li>      <li><a href="ref.exec.html">Program execution Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.shell-exec" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">shell_exec</h1>
  <p class="verinfo">(PHP 4, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">shell_exec</span> — <span class="dc-title">Execute command via shell and return the complete output as a string</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.shell-exec-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>shell_exec</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$cmd</code></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span>|<span class="type">null</span></span></div>

  <p class="para rdfs-comment">
   This function is identical to the <a href="language.operators.execution.html" class="link">backtick operator</a>.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    On Windows, the underlying pipe is opened in text mode which can cause the
    function to fail for binary output. Consider to use <span class="function"><a href="function.popen.html" class="function">popen()</a></span>
    instead for such cases.
   </p>
  <p></p></blockquote>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.shell-exec-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">cmd</code></dt>

     <dd>

      <p class="para">
       The command that will be executed.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.shell-exec-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   A <span class="type">string</span> containing the output from the executed command, <strong><code>false</code></strong> if the pipe
   cannot be established or <strong><code>null</code></strong> if an error occurs or the command produces no output.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    This function can return <strong><code>null</code></strong> both when an error occurs or the program
    produces no output. It is not possible to detect execution failures using
    this function. <span class="function"><a href="function.exec.html" class="function">exec()</a></span> should be used when access to the
    program exit code is required.
   </p>
  <p></p></blockquote>
 </div>

 
 <div class="refsect1 errors" id="refsect1-function.shell-exec-errors">
  <h3 class="title">Errors/Exceptions</h3> 
  <p class="para">
   An <strong><code>E_WARNING</code></strong> level error is generated
   when the pipe cannot be established.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.shell-exec-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-3276">
    <p><strong>Example #1 A <span class="function"><strong>shell_exec()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$output&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">shell_exec</span><span style="color: #007700">(</span><span style="color: #DD0000">'ls&nbsp;-lart'</span><span style="color: #007700">);<br>echo&nbsp;</span><span style="color: #DD0000">"&lt;pre&gt;</span><span style="color: #0000BB">$output</span><span style="color: #DD0000">&lt;/pre&gt;"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.shell-exec-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.exec.html" class="function" rel="rdfs-seeAlso">exec()</a> - Execute an external program</span></li>
    <li class="member"><span class="function"><a href="function.escapeshellcmd.html" class="function" rel="rdfs-seeAlso">escapeshellcmd()</a> - Escape shell metacharacters</span></li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="106250">  
  <a class="name">
  <strong class="user"><em>trev at dedicate.co.uk</em></strong></a><div class="date" title="2011-10-21 07:34"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom106250">
<div class="phpcode"><code><span class="html">
If you're trying to run a command such as "gunzip -t" in shell_exec and getting an empty result, you might need to add 2&gt;&amp;1 to the end of the command, eg:<br><br>Won't always work:<br>echo shell_exec("gunzip -c -t $path_to_backup_file");<br><br>Should work:<br>echo shell_exec("gunzip -c -t $path_to_backup_file 2&gt;&amp;1");<br><br>In the above example, a line break at the beginning of the gunzip output seemed to prevent shell_exec printing anything else. Hope this saves someone else an hour or two.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="118495">  
  <a class="name">
  <strong class="user"><em>alexandre dot schmidt at gmail dot com</em></strong></a><div class="date" title="2015-12-16 02:26"><strong>5 years ago</strong></div>
  <div class="text" id="Hcom118495">
<div class="phpcode"><code><span class="html">
To run a command in background, the output must be redirected to /dev/null. This is written in exec() manual page. There are cases where you need the output to be logged somewhere else though. Redirecting the output to a file like this didn't work for me:<br><br><span class="default">&lt;?php<br></span><span class="comment"># this doesn't work!<br></span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"my_script.sh 2&gt;&amp;1 &gt;&gt; /tmp/mylog &amp;"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Using the above command still hangs web browser request.<br><br>Seems like you have to add exactly "/dev/null" to the command line. For instance, this worked:<br><br><span class="default">&lt;?php<br></span><span class="comment"># works, but output is lost<br></span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"my_script.sh 2&gt;/dev/null &gt;/dev/null &amp;"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>But I wanted the output, so I used this:<br><br><span class="default">&lt;?php<br>shell_exec</span><span class="keyword">(</span><span class="string">"my_script.sh 2&gt;&amp;1 | tee -a /tmp/mylog 2&gt;/dev/null &gt;/dev/null &amp;"</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Hope this helps someone.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125577">  
  <a class="name">
  <strong class="user"><em>smcbride at msn dot com</em></strong></a><div class="date" title="2020-12-07 10:47"><strong>9 months ago</strong></div>
  <div class="text" id="Hcom125577">
<div class="phpcode"><code><span class="html">
proc_open is probably a better solution for most use cases as of PHP 7.4.&nbsp; There is better control and platform independence.&nbsp; If you still want to use shell_exec(), I like to wrap it with a function that allows better control.<br><br>Something like below solves some problems with background process issues on apache/php.&nbsp; It also <br><br>public function sh_exec(string $cmd, string $outputfile = "", string $pidfile = "", bool $mergestderror = true, bool $bg = false) {<br>&nbsp; $fullcmd = $cmd;<br>&nbsp; if(strlen($outputfile) &gt; 0) $fullcmd .= " &gt;&gt; " . $outputfile;<br>&nbsp; if($mergestderror) $fullcmd .= " 2&gt;&amp;1";<br>&nbsp; if($bg) {<br>&nbsp; &nbsp; $fullcmd = "nohup " . $fullcmd . " &amp;";<br>&nbsp; &nbsp; if(strlen($pidfile)) $fullcmd .= " echo $! &gt; " . $pidfile;<br>&nbsp; } else {<br>&nbsp; &nbsp; if(strlen($pidfile) &gt; 0) $fullcmd .= "; echo $$ &gt; " . $pidfile;<br>&nbsp; }<br>&nbsp; shell_exec($fullcmd);<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88052">  
  <a class="name">
  <strong class="user"><em>Rgemini</em></strong></a><div class="date" title="2009-01-07 03:46"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom88052">
<div class="phpcode"><code><span class="html">
A simple way to handle the problem of capturing stderr output when using shell-exec under windows is to call ob_start() before the command and ob_end_clean() afterwards, like this:<br><br><span class="default">&lt;?php<br>ob_start</span><span class="keyword">()<br></span><span class="default">$dir </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'dir B:'</span><span class="keyword">);<br>if </span><span class="default">is_null</span><span class="keyword">(</span><span class="default">$dir</span><span class="keyword">)<br>{&nbsp;&nbsp; </span><span class="comment">// B: does not exist<br>&nbsp; &nbsp; // do whatever you want with the stderr output here<br></span><span class="keyword">}<br>else<br>{&nbsp; </span><span class="comment">// B: exists and $dir holds the directory listing<br>&nbsp;&nbsp; // do whatever you want with it here<br></span><span class="keyword">}<br></span><span class="default">ob_end_clean</span><span class="keyword">();&nbsp;&nbsp; </span><span class="comment">// get rid of the evidence :-)<br></span><span class="default">?&gt;<br></span><br>If B: does not exist then $dir will be Null and the output buffer will have captured the message: <br><br>&nbsp; 'The system cannot find the path specified'. <br><br>(under WinXP, at least). If B: exists then $dir will contain the directory listing and we probably don't care about the output buffer. In any case it needs to be deleted before proceeding.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="31235">  
  <a class="name">
  <strong class="user"><em>mcbeth at broggs dot org</em></strong></a><div class="date" title="2003-04-14 02:18"><strong>18 years ago</strong></div>
  <div class="text" id="Hcom31235">
<div class="phpcode"><code><span class="html">
As far as error checking on the last example.&nbsp; Several of the shells have the &amp;&amp; operator, so you just string your commands together using it instead of ; If at any time any of the programs fail, you will return without running the rest</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78506">  
  <a class="name">
  <strong class="user"><em>kamermans at teratechnologies dot net</em></strong></a><div class="date" title="2007-10-15 08:01"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom78506">
<div class="phpcode"><code><span class="html">
I'm not sure what shell you are going to get with this function, but you can find out like this:<br><br><span class="default">&lt;?php<br>$cmd </span><span class="keyword">= </span><span class="string">'set'</span><span class="keyword">;<br>echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">.</span><span class="default">shell_exec</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">).</span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>On my FreeBSD 6.1 box I get this:<br><br>USER=root<br>LD_LIBRARY_PATH=/usr/local/lib/apache2:<br>HOME=/root<br>PS1='$ '<br>OPTIND=1<br>PS2='&gt; '<br>LOGNAME=root<br>PPID=88057<br>PATH=/etc:/bin:/sbin:/usr/bin:/usr/sbin<br>SHELL=/bin/sh<br>IFS='&nbsp; &nbsp;&nbsp; <br>'<br><br>Very interesting.&nbsp; Note that the PATH may not be as complete as you need.&nbsp; I wanted to run Ghostscript via ImageMagik's "convert" and ended up having to add my path before running the command:<br><br><span class="default">&lt;?php<br>$cmd </span><span class="keyword">= </span><span class="string">'export PATH="/usr/local/bin/"; convert -scale 25%x25% file1.pdf[0] file2.png 2&gt;&amp;1'</span><span class="keyword">;<br>echo </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">.</span><span class="default">shell_exec</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">).</span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;<br></span><span class="default">?&gt;<br></span><br>ALSO, note that shell_exec() does not grab STDERR, so use "2&gt;&amp;1" to redirect it to STDOUT and catch it.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="78279">  
  <a class="name">
  <strong class="user"><em>eric dot peyremorte at iut-valence dot fr</em></strong></a><div class="date" title="2007-10-05 02:01"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom78279">
<div class="phpcode"><code><span class="html">
I had trouble with accented caracters and shell_exec.<br><br>ex :<br><br>Executing this command from shell :<br><br>/usr/bin/smbclient '//BREZEME/peyremor' -c 'dir' -U 'peyremor%*********' -d 0 -W 'ADMINISTRATIF' -O 'TCP_NODELAY IPTOS_LOWDELAY SO_KEEPALIVE SO_RCVBUF=8192 SO_SNDBUF=8192' -b 1200 -N 2&gt;&amp;1<br><br>gave me that :<br><br>Vidéos&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; D&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Tue Jun 12 14:41:21 2007<br>&nbsp; Desktop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DH&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Mon Jun 18 17:41:36 2007<br><br>Using php like that :<br><br>shell_exec("/usr/bin/smbclient '//BREZEME/peyremor' -c 'dir' -U 'peyremor%*******' -d 0 -W 'ADMINISTRATIF' -O 'TCP_NODELAY IPTOS_LOWDELAY SO_KEEPALIVE SO_RCVBUF=8192 SO_SNDBUF=8192' -b 1200 -N 2&gt;&amp;1")<br><br>gave me that :<br><br>&nbsp; Vid&nbsp; Desktop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DH&nbsp; &nbsp; &nbsp; &nbsp; 0&nbsp; Mon Jun 18 17:41:36 2007<br><br>The two lines were concatenated from the place where the accent was.<br><br>I found the solution : php execute by default the command with LOCALE=C. <br><br>I just added the following lines before shell_exec and the problem was solved :<br><br>$locale = 'fr_FR.UTF-8';<br>setlocale(LC_ALL, $locale);<br>putenv('LC_ALL='.$locale);<br><br>Just adapt it to your language locale.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="90176">  
  <a class="name">
  <strong class="user"><em>joelhy</em></strong></a><div class="date" title="2009-04-08 06:29"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom90176">
<div class="phpcode"><code><span class="html">
Here is a easy way to grab STDERR and discard STDOUT:<br>&nbsp; &nbsp; add&nbsp; '2&gt;&amp;1 1&gt; /dev/null' to the end of your shell command<br><br>For example:<br><span class="default">&lt;?php<br>$output </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'ls file_not_exist 2&gt;&amp;1 1&gt; /dev/null'</span><span class="keyword">);<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123710">  
  <a class="name">
  <strong class="user"><em>pedroxam at gmail dot com</em></strong></a><div class="date" title="2019-03-20 10:50"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123710">
<div class="phpcode"><code><span class="html">
Here is my gist to all:<br><br>function execCommand($command, $log) {<br><br>&nbsp; &nbsp; if (substr(php_uname(), 0, 7) == "Windows")<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; //windows<br>&nbsp; &nbsp; &nbsp; &nbsp; pclose(popen("start /B " . $command . " 1&gt; $log 2&gt;&amp;1", "r"));<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; {<br>&nbsp; &nbsp; &nbsp; &nbsp; //linux<br>&nbsp; &nbsp; &nbsp; &nbsp; shell_exec( $command . " 1&gt; $log 2&gt;&amp;1" );<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; return false;<br>}</span>
</code></div>
  </div>
 </div>
  <div class="note" id="115702">  
  <a class="name">
  <strong class="user"><em>jack dot harris-7ot2j4ip at yopmail dot Com</em></strong></a><div class="date" title="2014-09-11 01:52"><strong>6 years ago</strong></div>
  <div class="text" id="Hcom115702">
<div class="phpcode"><code><span class="html">
On Windows, if shell_exec does NOT return the result you expected and the PC is on an enterprise network, set the Apache service (or wampapache) to run under your account instead of the 'Local system account'. Your account must have admin privileges.<br><br>To change the account go to console services, right click on the Apache service, choose properties, and select the connection tab.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="83151">  
  <a class="name">
  <strong class="user"><em>saivert at saivert dot com</em></strong></a><div class="date" title="2008-05-12 08:48"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom83151">
<div class="phpcode"><code><span class="html">
How to get the volume label of a drive on Windows<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">GetVolumeLabel</span><span class="keyword">(</span><span class="default">$drive</span><span class="keyword">) {<br>&nbsp; </span><span class="comment">// Try to grab the volume name<br>&nbsp; </span><span class="keyword">if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'#Volume in drive [a-zA-Z]* is (.*)\n#i'</span><span class="keyword">, </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'dir '</span><span class="keyword">.</span><span class="default">$drive</span><span class="keyword">.</span><span class="string">':'</span><span class="keyword">), </span><span class="default">$m</span><span class="keyword">)) {<br>&nbsp; &nbsp; </span><span class="default">$volname </span><span class="keyword">= </span><span class="string">' ('</span><span class="keyword">.</span><span class="default">$m</span><span class="keyword">[</span><span class="default">1</span><span class="keyword">].</span><span class="string">')'</span><span class="keyword">;<br>&nbsp; } else {<br>&nbsp; &nbsp; </span><span class="default">$volname </span><span class="keyword">= </span><span class="string">''</span><span class="keyword">;<br>&nbsp; }<br>return </span><span class="default">$volname</span><span class="keyword">;<br>}<br><br>print </span><span class="default">GetVolumeLabel</span><span class="keyword">(</span><span class="string">"c"</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Note: The regular expression assumes a english version of Windows is in use. modify it accordingly for a different localized copy of Windows.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="38905">  
  <a class="name">
  <strong class="user"><em>Martin Rampersad</em></strong></a><div class="date" title="2004-01-11 01:13"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom38905">
<div class="phpcode"><code><span class="html">
I have PHP (CGI) and Apache. I also shell_exec() shell scripts which use PHP CLI. This combination destroys the string value returned from the call. I get binary garbage.&nbsp; Shell scripts that start with #!/usr/bin/bash return their output properly.<br><br>A solution is to force a clean environment.&nbsp; PHP CLI no longer had the CGI environment variables to choke on.<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// Binary garbage.<br></span><span class="default">$ExhibitA </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'/home/www/myscript'</span><span class="keyword">);<br><br></span><span class="comment">// Perfect.<br></span><span class="default">$ExhibitB </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'env -i /home/www/myscript'</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>-- start /home/www/myscript<br>#!/usr/local/bin/phpcli<br><span class="default">&lt;?php<br><br></span><span class="keyword">echo(</span><span class="string">"Output.\n"</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span>-- end /home/www/myscript</span>
</code></div>
  </div>
 </div>
  <div class="note" id="48654">  
  <a class="name"><strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2005-01-03 09:10"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom48654">
<div class="phpcode"><code><span class="html">
Be careful as to how you elevate privileges to your php script.&nbsp; It's a good idea to use caution and planing.&nbsp; It is easy to open up huge security holes.&nbsp; Here are a couple of helpful hints I've gathered from experimentation and Unix documentation.<br><br>Things to think about:<br><br>1. If you are running php as an Apache module in Unix then every system command you run is run as user apache.&nbsp; This just makes sense.. Unix won't allow privileges to be elevated in this manner.&nbsp; If you need to run a system command with elevated privileges think through the problem carefully!<br><br>2. You are absolutely insane if you decide to run apache as root.&nbsp; You may as well kick yourself in the face.&nbsp; There is always a better way to do it.<br><br>3. If you decide to use a SUID it is best not to SUID a script.&nbsp; SUID is disabled for scripts on many flavors of Unix.&nbsp; SUID scripts open up security holes, so you don't always want to go this route even if it is an option.&nbsp; Write a simple binary and elevate the privileges of the binary as a SUID.&nbsp; In my own opinion it is a horrible idea to pass a system command through a SUID-- ie have the SUID accept the name of a command as a parameter.&nbsp; You may as well run Apache as root!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="79061">  
  <a class="name">
  <strong class="user"><em>RoBorg</em></strong></a><div class="date" title="2007-11-08 07:45"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom79061">
<div class="phpcode"><code><span class="html">
The Subversion error "svn: Can't recode string" can be caused by the locale being wrong.&nbsp; Try<br><span class="default">&lt;?php<br>putenv</span><span class="keyword">(</span><span class="string">'LANG=en_US.UTF-8'</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>(or whatever your preferred locale is) before you call shell_exec()</span>
</code></div>
  </div>
 </div>
  <div class="note" id="109693">  
  <a class="name">
  <strong class="user"><em>wally at soggysoftware dot co dot uk</em></strong></a><div class="date" title="2012-08-10 11:39"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom109693">
<div class="phpcode"><code><span class="html">
As others have noted, shell_exec and the backtick operator (`) both return NULL if the executed command doesn't output anything.<br><br>This can be worked around by doing anything like the following:<br><br>shell_exec ("silentcmd &amp;&amp; echo ' '");<br><br>Here we're simply outputting blank whitespace if&nbsp; the command succeeds - which satisfies this slightly strange issue.&nbsp; From there, you can trim() the command output etc.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95651">  
  <a class="name">
  <strong class="user"><em>codeslinger at compsalot dot com</em></strong></a><div class="date" title="2010-01-13 06:47"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom95651">
<div class="phpcode"><code><span class="html">
it took me a heck of a lot of head banging to finally solve this problem so I thought that I would mention it here.<br><br>If you are using Eclipse and you try to do something like<br><br><span class="default">&lt;?php<br><br>&nbsp; &nbsp; $out </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"php -s </span><span class="default">$File</span><span class="string">"</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">//this fails <br></span><span class="default">?&gt;<br></span><br>it will always fail when run inside of the Eclipse debugger.&nbsp; This happens on both Linux and Windows.&nbsp; I finally isolated the problem to changes that Eclipse makes to the environment when debugging.&nbsp;&nbsp; <br><br>The fix is to force the ini setting.&nbsp; If you don't need an ini then -n is sufficient.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; $out </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"php -n -s </span><span class="default">$File</span><span class="string">"</span><span class="keyword">);&nbsp;&nbsp; </span><span class="comment">//this works<br></span><span class="default">?&gt;<br></span><br>Of course if you run it outside of the debugger then it works fine without the -n.&nbsp;&nbsp; You may want to use a debug flag to control this behavior.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="20329">  
  <a class="name">
  <strong class="user"><em>tonysb at gmx dot net</em></strong></a><div class="date" title="2002-03-30 12:57"><strong>19 years ago</strong></div>
  <div class="text" id="Hcom20329">
<div class="phpcode"><code><span class="html">
shell_exec is extremely useful as a substitute for the virtual() function where unavailable (Microsoft IIS for example). All you have to do is remove the content type string sent in the header:<br><br>&lt;? <br>$mstrng = shell_exec('yourcgiscript.cgi');<br>$mstrng = ereg_replace( "Content-type: text/html", "", $mstrng );<br>echo $mstrng;<br>?&gt;<br><br>This works fine for me as a substitute for SSI or the virtual() func.<br><br>Anton Babadjanov<br><a rel="nofollow" target="_blank">http://www.vbcn.com.ar</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="37971">  
  <a class="name">
  <strong class="user"><em>jessop &lt;AT&gt; bigfoot &lt;DOT&gt; com</em></strong></a><div class="date" title="2003-12-03 12:19"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom37971">
<div class="phpcode"><code><span class="html">
Just a quick reminder for those trying to use shell_exec on a unix-type platform and can't seem to get it to work. PHP executes as the web user on the system (generally www for Apache), so you need to make sure that the web user has rights to whatever files or directories that you are trying to use in the shell_exec command. Other wise, it won't appear to be doing anything.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="67183">  
  <a class="name">
  <strong class="user"><em>rustleb at hotmail dot com</em></strong></a><div class="date" title="2006-06-05 01:45"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom67183">
<div class="phpcode"><code><span class="html">
For capturing stdout and stderr, when you don't care about the intermediate files, I've had better results with . . .<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">cmd_exec</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">, &amp;</span><span class="default">$stdout</span><span class="keyword">, &amp;</span><span class="default">$stderr</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; </span><span class="default">$outfile </span><span class="keyword">= </span><span class="default">tempnam</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">, </span><span class="string">"cmd"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$errfile </span><span class="keyword">= </span><span class="default">tempnam</span><span class="keyword">(</span><span class="string">"."</span><span class="keyword">, </span><span class="string">"cmd"</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$descriptorspec </span><span class="keyword">= array(<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">0 </span><span class="keyword">=&gt; array(</span><span class="string">"pipe"</span><span class="keyword">, </span><span class="string">"r"</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">1 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="default">$outfile</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">),<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">2 </span><span class="keyword">=&gt; array(</span><span class="string">"file"</span><span class="keyword">, </span><span class="default">$errfile</span><span class="keyword">, </span><span class="string">"w"</span><span class="keyword">)<br>&nbsp; &nbsp; );<br>&nbsp; &nbsp; </span><span class="default">$proc </span><span class="keyword">= </span><span class="default">proc_open</span><span class="keyword">(</span><span class="default">$cmd</span><span class="keyword">, </span><span class="default">$descriptorspec</span><span class="keyword">, </span><span class="default">$pipes</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if (!</span><span class="default">is_resource</span><span class="keyword">(</span><span class="default">$proc</span><span class="keyword">)) return </span><span class="default">255</span><span class="keyword">;<br><br>&nbsp; &nbsp; </span><span class="default">fclose</span><span class="keyword">(</span><span class="default">$pipes</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]);&nbsp; &nbsp; </span><span class="comment">//Don't really want to give any input<br><br>&nbsp; &nbsp; </span><span class="default">$exit </span><span class="keyword">= </span><span class="default">proc_close</span><span class="keyword">(</span><span class="default">$proc</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$stdout </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$outfile</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$stderr </span><span class="keyword">= </span><span class="default">file</span><span class="keyword">(</span><span class="default">$errfile</span><span class="keyword">);<br><br>&nbsp; &nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$outfile</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">unlink</span><span class="keyword">(</span><span class="default">$errfile</span><span class="keyword">);<br>&nbsp; &nbsp; return </span><span class="default">$exit</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;<br></span><br>This isn't much different than a redirection, except it takes care of the temp files for you (you may need to change the directory from ".") and it blocks automatically due to the proc_close call.&nbsp; This mimics the shell_exec behavior, plus gets you stderr.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="125899">  
  <a class="name">
  <strong class="user"><em>Numabyte</em></strong></a><div class="date" title="2021-03-11 06:01"><strong>6 months ago</strong></div>
  <div class="text" id="Hcom125899">
<div class="phpcode"><code><span class="html">
An important thing to consider is in some cases, like on MacOS, using "2&gt;&amp;1" to properly output string from exec() works well when you wrap the command in parenthesis. <br><br>For example:<br>WITH PARENTHESIS AROUND CMD<br>$cmd = "(mysqldump -h l ocalhost -u root -ppassword --databases login_practice_db &gt; /Users/username/Desktop/testDB.sql) 2&gt;&amp;1";<br><br>$sys = shell_exec($cmd ); //Works and produces an error (localhost is poorly spaced on purpose)<br><br>WITHOUT PARENTHESIS AROUND CMD<br> $cmd = "mysqldump -h l ocalhost -u root -ppassword --databases login_practice_db &gt; /Users/username/Desktop/testDB.sql 2&gt;&amp;1";<br><br>$sys = shell_exec($cmd ); //Does nothing and goes blank as if the result were error free. Empty string.<br><br>It's interesting how shell command execution can get down to how nuanced one might need to be with string parsing.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="88621">  
  <a class="name">
  <strong class="user"><em>dburles@NOSPAMgmailDOTcom</em></strong></a><div class="date" title="2009-02-01 03:07"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom88621">
<div class="phpcode"><code><span class="html">
Easy way to capture error output in windows<br><br>// we'll execute a php script as an example:<br>$out = shell_exec("php test.php 2&gt; output");<br>print $out ? $out : join("", file("output"));<br><br>We assume in this case if the script produces output it has ran ok, the $out variable will then contain the output, if $out is empty then we read the captured error output from a file simply called 'output'.<br><br>Hope this helps someone</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122676">  
  <a class="name">
  <strong class="user"><em>smithnigelw at gmail dot com</em></strong></a><div class="date" title="2018-04-27 02:13"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122676">
<div class="phpcode"><code><span class="html">
With PHP on Windows, if you get the 'Warning: shell_exec() [function.shell-exec]: Unable to execute' error, then you need to check the permissions on file 'C:\WINDOWS\system32\cmd.exe'. You need read/execute permission on this file.&nbsp; I would recommend using the sysinternals Process Monitor 'procmon.exe' to confirm the user that is trying to run 'cmd.exe'. Filter on 'Process Name' is 'php-cgi.exe' and 'Path' ends with 'cmd.exe'. Look at the event properties for the task with the access denied error, and it will show you the 'Impersonating' user name.&nbsp; This is usually the 'Internet Guest Account', often 'NT AUTHORITY\IUSR'.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="96249">  
  <a class="name">
  <strong class="user"><em>martin at intelli-gens dot com</em></strong></a><div class="date" title="2010-02-17 03:21"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom96249">
<div class="phpcode"><code><span class="html">
Also after lots of hair pulling why shell_exec didn't want to work for me I found out that in my case some things needed to be set (which normally are set by default).<br><br>the options -jo&nbsp; <br>-j means: don't recreate the paths found in the archive<br>-o means: always overwrite files<br><br>And I needed to specify the destination path (even though it should unzip in the same directory when not specified), this is done by -d [path]<br><br>The strange thing was that I didn't have to put these options when I would give the command on the command-line, only when I would call it with shell_exec.<br><br>So the complete command in php would be for me:<br><br>shell_exec('unzip -jo /path_to_archive/archive.zip&nbsp; -d /destination_path')<br><br>And putting en echo in front will help you a lot.<br>it should tell you something like this:<br>&nbsp; &nbsp;&nbsp; <br><br>Archive:&nbsp; /path_to_zip/archive.zip<br>&nbsp; inflating: /destination_path/file1.jpeg&nbsp; <br>&nbsp; inflating: /destination_path/file2.jpeg<br>&nbsp; inflating: /destination_path/file3.jpeg</span>
</code></div>
  </div>
 </div>
  <div class="note" id="82278">  
  <a class="name">
  <strong class="user"><em>gabekon at gmail dot com</em></strong></a><div class="date" title="2008-04-03 08:33"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom82278">
<div class="phpcode"><code><span class="html">
RE: kamermans note,<br><br>I was having a similar problem with the PATH variable when using shell_exec. Even with a hard-coded full path to a binary, I also got an error about a .so file that could not be found. After some reading up, I realized I had to set the LD_LIBRARY_PATH variable:<br><br><span class="default">&lt;?php<br><br>$command </span><span class="keyword">= </span><span class="string">'export LD_LIBRARY_PATH="' </span><span class="keyword">. </span><span class="default">$path_to_library_dir </span><span class="keyword">.</span><span class="string">'"; ' </span><span class="keyword">. </span><span class="default">$path_to_binary</span><span class="keyword">;<br></span><span class="default">shell_exec</span><span class="keyword">(</span><span class="default">$command</span><span class="keyword">);<br><br></span><span class="default">?&gt;<br></span><br>Hope this saves someone a headache,<br><br>- G</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69706">  
  <a class="name">
  <strong class="user"><em>Paul Cook</em></strong></a><div class="date" title="2006-09-16 11:00"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom69706">
<div class="phpcode"><code><span class="html">
The technique mentioned by Nathan De Hert below is rather insecure -- you should never leave a password lying around in a file readable by the apache user.<br><br>If you need this sort of functionality on *nix systems, have a look at the /etc/sudo file (edited with the command 'visudo'). The tag NOPASSWD allows specified commands to be run as root by another user, without needing to specify a password. It's a little extra configuration, but much more secure.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="69160">  
  <a class="name">
  <strong class="user"><em>ruan at nospam dot tillcor dot com</em></strong></a><div class="date" title="2006-08-24 08:31"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom69160">
<div class="phpcode"><code><span class="html">
When following Kenneth's method for executing root scripts via the nanoweb server mentioned on this page you would most likely need to be able to run a text-mode browser like lynx and pass the php script to it (works great).<br><br>After struggling for a while (lynx kept asking me to download the file instead of executing it), I realised that I had to install php-cgi additionally and modify the nanoweb config file&nbsp; to use that php interpreter instead of /usr/bin/php. (On Debian this is the CLI version).<br><br>On Ubuntu 6.06:<br><br>apt-get install php5-cgi<br><br>After editing /etc/nanoweb/nanoweb.conf and a quick restart of the web server, lynx and links will execute your PHP scripts properly.<br><br>Hope this helps somebody else out there :)<br><br>Ruan Fourie</span>
</code></div>
  </div>
 </div>
  <div class="note" id="59898">  
  <a class="name">
  <strong class="user"><em>Ashraf Kaabi</em></strong></a><div class="date" title="2005-12-19 10:06"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom59898">
<div class="phpcode"><code><span class="html">
I've write a Full Class for Run in Background, Kill PID , check if is Running <br><br><span class="default">&lt;?php<br></span><span class="comment">/**<br> * @author&nbsp; &nbsp;&nbsp; Ashraf M Kaabi<br> * @name&nbsp; &nbsp; &nbsp;&nbsp; Advance Linux Exec<br> */<br></span><span class="keyword">class </span><span class="default">exec </span><span class="keyword">{<br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * Run Application in background<br>&nbsp; &nbsp;&nbsp; *<br>&nbsp; &nbsp;&nbsp; * @param&nbsp; &nbsp;&nbsp; unknown_type $Command<br>&nbsp; &nbsp;&nbsp; * @param&nbsp; &nbsp;&nbsp; unknown_type $Priority<br>&nbsp; &nbsp;&nbsp; * @return&nbsp; &nbsp;&nbsp; PID<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">background</span><span class="keyword">(</span><span class="default">$Command</span><span class="keyword">, </span><span class="default">$Priority </span><span class="keyword">= </span><span class="default">0</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">$Priority</span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$PID </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"nohup nice -n </span><span class="default">$Priority</span><span class="string"> </span><span class="default">$Command</span><span class="string"> &gt; /dev/null &amp; echo $!"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp;&nbsp; else<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">$PID </span><span class="keyword">= </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">"nohup </span><span class="default">$Command</span><span class="string"> &gt; /dev/null &amp; echo $!"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">$PID</span><span class="keyword">);<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp; * Check if the Application running !<br>&nbsp; &nbsp; *<br>&nbsp; &nbsp; * @param&nbsp; &nbsp;&nbsp; unknown_type $PID<br>&nbsp; &nbsp; * @return&nbsp; &nbsp;&nbsp; boolen<br>&nbsp; &nbsp; */<br>&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">is_running</span><span class="keyword">(</span><span class="default">$PID</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">(</span><span class="string">"ps </span><span class="default">$PID</span><span class="string">"</span><span class="keyword">, </span><span class="default">$ProcessState</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp;&nbsp; return(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$ProcessState</span><span class="keyword">) &gt;= </span><span class="default">2</span><span class="keyword">);<br>&nbsp;&nbsp; }<br>&nbsp;&nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp; * Kill Application PID<br>&nbsp; &nbsp; *<br>&nbsp; &nbsp; * @param&nbsp; unknown_type $PID<br>&nbsp; &nbsp; * @return boolen<br>&nbsp; &nbsp; */<br>&nbsp;&nbsp; </span><span class="keyword">function </span><span class="default">kill</span><span class="keyword">(</span><span class="default">$PID</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp;&nbsp; if(</span><span class="default">exec</span><span class="keyword">::</span><span class="default">is_running</span><span class="keyword">(</span><span class="default">$PID</span><span class="keyword">)){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="default">exec</span><span class="keyword">(</span><span class="string">"kill -KILL </span><span class="default">$PID</span><span class="string">"</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return </span><span class="default">true</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp;&nbsp; }else return </span><span class="default">false</span><span class="keyword">;<br>&nbsp;&nbsp; }<br>};<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="56935">  
  <a class="name">
  <strong class="user"><em>concept at conceptonline dot hu</em></strong></a><div class="date" title="2005-09-19 02:02"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom56935">
<div class="phpcode"><code><span class="html">
Interestingly, if you execute a script which is not in your path (or you have made a typo, or if the script does no exist at all), you will get no return value. The error will be logged into the error_log of your webserver.<br><br>Someone could add a note how this can be (if it could be) overriden, as the standard behaviour is not really fool-proof.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="51782">  
  <a class="name">
  <strong class="user"><em>phillipberry at NOSPAM dot blisswebhosting dot com</em></strong></a><div class="date" title="2005-04-11 01:13"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom51782">
<div class="phpcode"><code><span class="html">
I found something odd.<br><br>If you run exec then straight after shell_exec the shell_exec will simply not run and will return NULL.<br><br>To get it to work i put a sleep(5) after the exec and now shell_exec works fine.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="44438">  
  <a class="name">
  <strong class="user"><em>James McCormack</em></strong></a><div class="date" title="2004-08-05 01:50"><strong>17 years ago</strong></div>
  <div class="text" id="Hcom44438">
<div class="phpcode"><code><span class="html">
I had a perl program which ran fine from command line but not using shell_exec(), exec() or system() - nothing was being returned. I was using the full path and permissions were set correctly.<br><br>It turned out the perl program was using more memory than my PHP.INI file was set to allow. Increasing "memory_limit" solved the problem.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="61998">  
  <a class="name">
  <strong class="user"><em>rigsbr at yahoo dot com dot br</em></strong></a><div class="date" title="2006-02-16 06:24"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom61998">
<div class="phpcode"><code><span class="html">
If you need to execute a command without permission and could not execute it by ssh or install any extension, there is a way in Apache 1.3.x and PHP 4.<br>Create a file on cgi-bin directory, like this:<br><br>#!/usr/bin/php<br>&lt;?<br>&nbsp; echo shell_exec('whoami');<br>?&gt;<br><br>Don't forget to set the file you created the permission to execute it. Hence, call it from browser and you will se that this script will be executed by the shell user and not the user nobody (apache default user if running a PHP script).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="57215">  
  <a class="name">
  <strong class="user"><em>php [AT] jsomers [DOT] be</em></strong></a><div class="date" title="2005-09-27 06:00"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom57215">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br><br></span><span class="comment">/**<br> * PHP Kill Process<br> *<br> * Sometimes, it can happen a script keeps running when it shouldn't, and it<br> * won't stop after we close the browser, or shutdown the computer. Because it's<br> * not always easy to use SSH there's a workaround.<br> *<br> * @author&nbsp; &nbsp; &nbsp; Jensen Somers &lt;php@jsomers.be&gt;<br> * @version&nbsp; &nbsp;&nbsp; 1.0<br> */<br> <br></span><span class="keyword">class </span><span class="default">KillAllProcesses </span><span class="keyword">{<br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * Construct the class<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">killallprocesses</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">listItems</span><span class="keyword">();<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * List all the items<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">listItems</span><span class="keyword">() {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/*<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * PS&nbsp;&nbsp; Unix command to report process status<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * -x&nbsp;&nbsp; Select processes without controlling ttys<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Output will look like:<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; 16479 pts/13&nbsp;&nbsp; S&nbsp; &nbsp; &nbsp; 0:00 -bash<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; 21944 pts/13&nbsp;&nbsp; R&nbsp; &nbsp; &nbsp; 0:00 ps -x<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$output </span><span class="keyword">=&nbsp;&nbsp; </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'ps -x'</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">output</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">// Put each individual line into an array<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$array&nbsp; </span><span class="keyword">=&nbsp;&nbsp; </span><span class="default">explode</span><span class="keyword">(</span><span class="string">"\n"</span><span class="keyword">, </span><span class="default">$output</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">doKill</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">);<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * Print the process list<br>&nbsp; &nbsp;&nbsp; * @param&nbsp;&nbsp; string&nbsp; $output<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">output</span><span class="keyword">(</span><span class="default">$output</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; print&nbsp;&nbsp; </span><span class="string">"&lt;pre&gt;"</span><span class="keyword">.</span><span class="default">$output</span><span class="keyword">.</span><span class="string">"&lt;/pre&gt;"</span><span class="keyword">;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">/**<br>&nbsp; &nbsp;&nbsp; * Kill all the processes<br>&nbsp; &nbsp;&nbsp; * It should be possible to filter in this, but I won't do it now.<br>&nbsp; &nbsp;&nbsp; * @param&nbsp;&nbsp; array&nbsp;&nbsp; $array<br>&nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; </span><span class="keyword">function </span><span class="default">doKill</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="comment">/*<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * Because the first line of our $output will look like<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; *&nbsp; &nbsp; &nbsp; &nbsp; PID TTY&nbsp; &nbsp; &nbsp; STAT&nbsp;&nbsp; TIME COMMAND<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; * we'll skip this one.<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; */<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="keyword">for (</span><span class="default">$i </span><span class="keyword">= </span><span class="default">1</span><span class="keyword">; </span><span class="default">$i </span><span class="keyword">&lt; </span><span class="default">count</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">); </span><span class="default">$i</span><span class="keyword">++) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$id </span><span class="keyword">=&nbsp;&nbsp; </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="default">0</span><span class="keyword">, </span><span class="default">strpos</span><span class="keyword">(</span><span class="default">$array</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">], </span><span class="string">' ?'</span><span class="keyword">));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">shell_exec</span><span class="keyword">(</span><span class="string">'kill '</span><span class="keyword">.</span><span class="default">$id</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>}<br><br>new </span><span class="default">KillAllProcesses</span><span class="keyword">();<br><br></span><span class="default">?&gt;<br></span><br>It's not the very best solution, but I've used it a couple of times when I needed to do it quick without to much trouble.<br>Make not I kill all the processes, on my server px -x will only return like 4 times /sbin/apache and it's pretty safe to kill them without any trouble.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="123226">  
  <a class="name">
  <strong class="user"><em>ricky at rocker dot com</em></strong></a><div class="date" title="2018-10-12 10:21"><strong>2 years ago</strong></div>
  <div class="text" id="Hcom123226">
<div class="phpcode"><code><span class="html">
despite: <br><br>shell_exec("env")<br><br>returning <br><br>SHELL=/bin/bash<br><br>I simply could not get:<br><br>shell_exec("bash command &lt;(another bash command)")<br><br>to work. I have now got it working by forcing the bash shell using: <br><br>shell_exec("bash -c \"bash command &lt;(another bash command)\"")</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.shell-exec.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:48:22 GMT -->

</body></html>