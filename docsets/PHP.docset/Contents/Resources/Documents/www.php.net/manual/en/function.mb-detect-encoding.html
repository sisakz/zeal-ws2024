<html><!-- Mirrored from www.php.net/manual/en/function.mb-detect-encoding.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:11:05 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>mb_detect_encoding</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mb-detect-encoding.html">
 <link rel="shorturl" href="https://www.php.net/mb-detect-encoding">
 <link rel="alternate" href="https://www.php.net/mb-detect-encoding" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mbstring.html">
 <link rel="prev" href="function.mb-decode-numericentity.html">
 <link rel="next" href="function.mb-detect-order.html">

 <link rel="alternate" href="function.mb-detect-encoding.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.mb-detect-encoding.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.mb-detect-encoding.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.mb-detect-encoding.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.mb-detect-encoding.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.mb-detect-encoding.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.mb-detect-encoding.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.mb-detect-encoding.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.mb-detect-encoding.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.mb-detect-encoding.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.international.html">Human Language and Character Encoding Support</a></li>      <li><a href="book.mbstring.html">Multibyte String</a></li>      <li><a href="ref.mbstring.html">Multibyte String Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.mb-detect-encoding" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mb_detect_encoding</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.0.6, PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">mb_detect_encoding</span> — <span class="dc-title">Detect character encoding</span></p>

 </div>

 <div class="refsect1 description" id="refsect1-function.mb-detect-encoding-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mb_detect_encoding</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$string</code></span>, <span class="methodparam"><span class="type"><span class="type">array</span>|<span class="type">string</span>|<span class="type">null</span></span> <code class="parameter">$encodings</code><span class="initializer"> = <strong><code>null</code></strong></span></span>, <span class="methodparam"><span class="type">bool</span> <code class="parameter">$strict</code><span class="initializer"> = <strong><code>false</code></strong></span></span>): <span class="type"><span class="type">string</span>|<span class="type"><span class="type false">false</span></span></span></div>

  <p class="para rdfs-comment">
   Detects the most likely character encoding for <span class="type">string</span> <code class="parameter">string</code>
   from an ordered list of candidates.
  </p>
  <p class="para">
   Automatic detection of the intended character encoding can never be entirely reliable;
   without some additional information, it is similar to decoding an encrypted string
   without the key. It is always preferable to use an indication of character encoding
   stored or transmitted with the data, such as a "Content-Type" HTTP header.
  </p>
  <p class="para">
   This function is most useful with multibyte encodings, where not all sequences of
   bytes form a valid string. If the input string contains such a sequence, that
   encoding will be rejected, and the next encoding checked.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mb-detect-encoding-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">string</code></dt>

     <dd>

      <p class="para">
       The <span class="type">string</span> being inspected.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">encodings</code></dt>

     <dd>

      <p class="para">
       A list of character encodings to try, in order. The list may be specified as
       an array of strings, or a single string separated by commas.
      </p>
      <p class="para">
       If <code class="parameter">encodings</code> is omitted or <strong><code>null</code></strong>,
       the current detect_order (set with the <a href="mbstring.configuration.html#ini.mbstring.detect-order" class="link">
       mbstring.detect_order</a> configuration option, or <span class="function"><a href="function.mb-detect-order.html" class="function">mb_detect_order()</a></span>
       function) will be used.
      </p>
     </dd>

    
    
     <dt>
<code class="parameter">strict</code></dt>

     <dd>

      <p class="para">
       Controls the behaviour when <code class="parameter">string</code>
       is not valid in any of the listed <code class="parameter">encodings</code>.
       If <code class="parameter">strict</code> is set to <strong><code>false</code></strong>, the closest matching
       encoding will be returned; if <code class="parameter">strict</code> is set to <strong><code>true</code></strong>,
       <strong><code>false</code></strong> will be returned.
      </p>
      <p class="para">
       The default value for <code class="parameter">strict</code> can be set
       with the <a href="mbstring.configuration.html#ini.mbstring.strict-detection" class="link">
       mbstring.strict_detection</a> configuration option.
      </p>
     </dd>

    
   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mb-detect-encoding-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   The detected character encoding, or <strong><code>false</code></strong> if the string is not valid
   in any of the listed encodings.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-function.mb-detect-encoding-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-2501">
    <p><strong>Example #1 <span class="function"><strong>mb_detect_encoding()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;Detect&nbsp;character&nbsp;encoding&nbsp;with&nbsp;current&nbsp;detect_order<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;"auto"&nbsp;is&nbsp;expanded&nbsp;according&nbsp;to&nbsp;mbstring.language<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"auto"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Specify&nbsp;"encodings"&nbsp;parameter&nbsp;by&nbsp;list&nbsp;separated&nbsp;by&nbsp;comma<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"JIS,&nbsp;eucjp-win,&nbsp;sjis-win"</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;Use&nbsp;array&nbsp;to&nbsp;specify&nbsp;"encodings"&nbsp;parameter<br></span><span style="color: #0000BB">$encodings&nbsp;</span><span style="color: #007700">=&nbsp;[<br>&nbsp;&nbsp;</span><span style="color: #DD0000">"ASCII"</span><span style="color: #007700">,<br>&nbsp;&nbsp;</span><span style="color: #DD0000">"JIS"</span><span style="color: #007700">,<br>&nbsp;&nbsp;</span><span style="color: #DD0000">"EUC-JP"<br></span><span style="color: #007700">];<br>echo&nbsp;</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$encodings</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-2502">
    <p><strong>Example #2 Effect of <code class="parameter">strict</code> parameter</strong></p>
    <div class="example-contents">
     <div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;'áéóú'&nbsp;encoded&nbsp;in&nbsp;ISO-8859-1<br></span><span style="color: #0000BB">$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"\xE1\xE9\xF3\xFA"</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;string&nbsp;is&nbsp;not&nbsp;valid&nbsp;ASCII&nbsp;or&nbsp;UTF-8,&nbsp;but&nbsp;UTF-8&nbsp;is&nbsp;considered&nbsp;a&nbsp;closer&nbsp;match<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'ASCII'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">));<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'ASCII'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">));<br><br></span><span style="color: #FF8000">//&nbsp;If&nbsp;a&nbsp;valid&nbsp;encoding&nbsp;is&nbsp;found,&nbsp;the&nbsp;strict&nbsp;parameter&nbsp;does&nbsp;not&nbsp;change&nbsp;the&nbsp;result<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'ASCII'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">));<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'ASCII'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>string(5) "UTF-8"
bool(false)
string(10) "ISO-8859-1"
string(10) "ISO-8859-1"
</pre></div>
    </div>
   </div>
  <p></p>
  <p class="para">
   In some cases, the same sequence of bytes may form a valid string in multiple
   character encodings, and it is impossible to know which interpretation was
   intended. For instance, among many others, the byte sequence "\xC4\xA2" could be:
  </p>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member">
     "Ä¢" (U+00C4 LATIN CAPITAL LETTER A WITH DIAERESIS followed by U+00A2 CENT SIGN)
     encoded in any of ISO-8859-1, ISO-8859-15, or Windows-1252
    </li>
    <li class="member">
     "ФЂ" (U+0424 CYRILLIC CAPITAL LETTER EF followed by U+0402 CYRILLIC CAPITAL LETTER
     DJE) encoded in ISO-8859-5
    </li>
    <li class="member">
     "Ģ" (U+0122 LATIN CAPITAL LETTER G WITH CEDILLA) encoded in UTF-8
    </li>
   </ul>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-2503">
    <p><strong>Example #3 Effect of order when multiple encodings match</strong></p>
    <div class="example-contents">
     <div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$str&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"\xC4\xA2"</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&nbsp;The&nbsp;string&nbsp;is&nbsp;valid&nbsp;in&nbsp;all&nbsp;three&nbsp;encodings,&nbsp;so&nbsp;the&nbsp;first&nbsp;one&nbsp;listed&nbsp;will&nbsp;be&nbsp;returned<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-5'</span><span style="color: #007700">]));<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-5'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">]));<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">mb_detect_encoding</span><span style="color: #007700">(</span><span style="color: #0000BB">$str</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'ISO-8859-5'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'UTF-8'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'ISO-8859-1'</span><span style="color: #007700">]));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>string(5) "UTF-8"
string(10) "ISO-8859-1"
string(10) "ISO-8859-5"
</pre></div>
    </div>
   </div>
  <p></p>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mb-detect-encoding-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mb-detect-order.html" class="function" rel="rdfs-seeAlso">mb_detect_order()</a> - Set/Get character encoding detection order</span></li>
   </ul>
  <p></p>
 </div>


</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="102510">  
  <a class="name">
  <strong class="user"><em>Gerg Tisza</em></strong></a><div class="date" title="2011-02-18 03:43"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom102510">
<div class="phpcode"><code><span class="html">
If you try to use mb_detect_encoding to detect whether a string is valid UTF-8, use the strict mode, it is pretty worthless otherwise.<br><br><span class="default">&lt;?php<br>&nbsp; &nbsp; $str </span><span class="keyword">= </span><span class="string">'áéóú'</span><span class="keyword">; </span><span class="comment">// ISO-8859-1<br>&nbsp; &nbsp; </span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">); </span><span class="comment">// 'UTF-8'<br>&nbsp; &nbsp; </span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">); </span><span class="comment">// false<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="51389">  
  <a class="name">
  <strong class="user"><em>Chrigu</em></strong></a><div class="date" title="2005-03-29 07:32"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom51389">
<div class="phpcode"><code><span class="html">
If you need to distinguish between UTF-8 and ISO-8859-1 encoding, list UTF-8 first in your encoding_list:<br>mb_detect_encoding($string, 'UTF-8, ISO-8859-1');<br><br>if you list ISO-8859-1 first, mb_detect_encoding() will always return ISO-8859-1.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="77581">  
  <a class="name">
  <strong class="user"><em>rl at itfigures dot nl</em></strong></a><div class="date" title="2007-09-04 02:00"><strong>14 years ago</strong></div>
  <div class="text" id="Hcom77581">
<div class="phpcode"><code><span class="html">
I used Chris's function "detectUTF8" to detect the need from conversion from utf8 to 8859-1, which works fine. I did have a problem with the following iconv-conversion.<br><br>The problem is that the iconv-conversion to 8859-1 (with //TRANSLIT) replaces the euro-sign with EUR, although it is common practice&nbsp; that \x80 is used as the euro-sign in the 8859-1 charset. <br><br>I could not use 8859-15 since that mangled some other characters, so I added 2 str_replace's:<br><br>if(detectUTF8($str)){<br>&nbsp; $str=str_replace("\xE2\x82\xAC","&amp;euro;",$str); <br>&nbsp; $str=iconv("UTF-8","ISO-8859-1//TRANSLIT",$str);<br>&nbsp; $str=str_replace("&amp;euro;","\x80",$str); <br>}<br><br>If html-output is needed the last line is not necessary (and even unwanted).</span>
</code></div>
  </div>
 </div>
  <div class="note" id="68607">  
  <a class="name">
  <strong class="user"><em>chris AT w3style.co DOT uk</em></strong></a><div class="date" title="2006-08-03 02:22"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom68607">
<div class="phpcode"><code><span class="html">
Based upon that snippet below using preg_match() I needed something faster and less specific.&nbsp; That function works and is brilliant but it scans the entire strings and checks that it conforms to UTF-8.&nbsp; I wanted something purely to check if a string contains UTF-8 characters so that I could switch character encoding from iso-8859-1 to utf-8.<br><br>I modified the pattern to only look for non-ascii multibyte sequences in the UTF-8 range and also to stop once it finds at least one multibytes string.&nbsp; This is quite a lot faster.<br><br><span class="default">&lt;?php<br><br></span><span class="keyword">function </span><span class="default">detectUTF8</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)<br>{<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'%(?:<br>&nbsp; &nbsp; &nbsp; &nbsp; [\xC2-\xDF][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; # non-overlong 2-byte<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xE0[\xA0-\xBF][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # excluding overlongs<br>&nbsp; &nbsp; &nbsp; &nbsp; |[\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}&nbsp; &nbsp; &nbsp; # straight 3-byte<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xED[\x80-\x9F][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # excluding surrogates<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xF0[\x90-\xBF][\x80-\xBF]{2}&nbsp; &nbsp; # planes 1-3<br>&nbsp; &nbsp; &nbsp; &nbsp; |[\xF1-\xF3][\x80-\xBF]{3}&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # planes 4-15<br>&nbsp; &nbsp; &nbsp; &nbsp; |\xF4[\x80-\x8F][\x80-\xBF]{2}&nbsp; &nbsp; # plane 16<br>&nbsp; &nbsp; &nbsp; &nbsp; )+%xs'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br>}<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="86165">  
  <a class="name">
  <strong class="user"><em>dennis at nikolaenko dot ru</em></strong></a><div class="date" title="2008-10-06 09:18"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom86165">
<div class="phpcode"><code><span class="html">
Beware of bug to detect Russian encodings<br><a rel="nofollow" target="_blank">http://bugs.php.net/bug.php?id=38138</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="91051">  
  <a class="name">
  <strong class="user"><em>nat3738 at gmail dot com</em></strong></a><div class="date" title="2009-05-22 03:58"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom91051">
<div class="phpcode"><code><span class="html">
A simple way to detect UTF-8/16/32 of file by its BOM (not work with string or file without BOM)<br><br><span class="default">&lt;?php<br></span><span class="comment">// Unicode BOM is U+FEFF, but after encoded, it will look like this.<br></span><span class="default">define </span><span class="keyword">(</span><span class="string">'UTF32_BIG_ENDIAN_BOM'&nbsp;&nbsp; </span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x00</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x00</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFE</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFF</span><span class="keyword">));<br></span><span class="default">define </span><span class="keyword">(</span><span class="string">'UTF32_LITTLE_ENDIAN_BOM'</span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFF</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFE</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x00</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0x00</span><span class="keyword">));<br></span><span class="default">define </span><span class="keyword">(</span><span class="string">'UTF16_BIG_ENDIAN_BOM'&nbsp;&nbsp; </span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFE</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFF</span><span class="keyword">));<br></span><span class="default">define </span><span class="keyword">(</span><span class="string">'UTF16_LITTLE_ENDIAN_BOM'</span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFF</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xFE</span><span class="keyword">));<br></span><span class="default">define </span><span class="keyword">(</span><span class="string">'UTF8_BOM'&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; </span><span class="keyword">, </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xEF</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBB</span><span class="keyword">) . </span><span class="default">chr</span><span class="keyword">(</span><span class="default">0xBF</span><span class="keyword">));<br><br>function </span><span class="default">detect_utf_encoding</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">) {<br><br>&nbsp; &nbsp; </span><span class="default">$text </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="default">$filename</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$first2 </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">2</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$first3 </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br>&nbsp; &nbsp; </span><span class="default">$first4 </span><span class="keyword">= </span><span class="default">substr</span><span class="keyword">(</span><span class="default">$text</span><span class="keyword">, </span><span class="default">0</span><span class="keyword">, </span><span class="default">3</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if (</span><span class="default">$first3 </span><span class="keyword">== </span><span class="default">UTF8_BOM</span><span class="keyword">) return </span><span class="string">'UTF-8'</span><span class="keyword">;<br>&nbsp; &nbsp; elseif (</span><span class="default">$first4 </span><span class="keyword">== </span><span class="default">UTF32_BIG_ENDIAN_BOM</span><span class="keyword">) return </span><span class="string">'UTF-32BE'</span><span class="keyword">;<br>&nbsp; &nbsp; elseif (</span><span class="default">$first4 </span><span class="keyword">== </span><span class="default">UTF32_LITTLE_ENDIAN_BOM</span><span class="keyword">) return </span><span class="string">'UTF-32LE'</span><span class="keyword">;<br>&nbsp; &nbsp; elseif (</span><span class="default">$first2 </span><span class="keyword">== </span><span class="default">UTF16_BIG_ENDIAN_BOM</span><span class="keyword">) return </span><span class="string">'UTF-16BE'</span><span class="keyword">;<br>&nbsp; &nbsp; elseif (</span><span class="default">$first2 </span><span class="keyword">== </span><span class="default">UTF16_LITTLE_ENDIAN_BOM</span><span class="keyword">) return </span><span class="string">'UTF-16LE'</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="85294">  
  <a class="name">
  <strong class="user"><em>hmdker at gmail dot com</em></strong></a><div class="date" title="2008-08-23 09:58"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom85294">
<div class="phpcode"><code><span class="html">
Function to detect UTF-8, when mb_detect_encoding is not available it may be useful.<br><br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">is_utf8</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$c</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$b</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">;<br>&nbsp; &nbsp; </span><span class="default">$len</span><span class="keyword">=</span><span class="default">strlen</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">);<br>&nbsp; &nbsp; for(</span><span class="default">$i</span><span class="keyword">=</span><span class="default">0</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">&lt;</span><span class="default">$len</span><span class="keyword">; </span><span class="default">$i</span><span class="keyword">++){<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$c</span><span class="keyword">=</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$c </span><span class="keyword">&gt; </span><span class="default">128</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if((</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">254</span><span class="keyword">)) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">252</span><span class="keyword">) </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">6</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">248</span><span class="keyword">) </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">5</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">240</span><span class="keyword">) </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">4</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">224</span><span class="keyword">) </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">3</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif(</span><span class="default">$c </span><span class="keyword">&gt;= </span><span class="default">192</span><span class="keyword">) </span><span class="default">$bits</span><span class="keyword">=</span><span class="default">2</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; else return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if((</span><span class="default">$i</span><span class="keyword">+</span><span class="default">$bits</span><span class="keyword">) &gt; </span><span class="default">$len</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; while(</span><span class="default">$bits </span><span class="keyword">&gt; </span><span class="default">1</span><span class="keyword">){<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$i</span><span class="keyword">++;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$b</span><span class="keyword">=</span><span class="default">ord</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">[</span><span class="default">$i</span><span class="keyword">]);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(</span><span class="default">$b </span><span class="keyword">&lt; </span><span class="default">128 </span><span class="keyword">|| </span><span class="default">$b </span><span class="keyword">&gt; </span><span class="default">191</span><span class="keyword">) return </span><span class="default">false</span><span class="keyword">;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$bits</span><span class="keyword">--;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">true</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="50087">  
  <a class="name">
  <strong class="user"><em>php-note-2005 at ryandesign dot com</em></strong></a><div class="date" title="2005-02-17 07:57"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom50087">
<div class="phpcode"><code><span class="html">
Much simpler UTF-8-ness checker using a regular expression created by the W3C:<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// Returns true if $string is valid UTF-8 and false otherwise.<br></span><span class="keyword">function </span><span class="default">is_utf8</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; </span><span class="comment">// From <a rel="nofollow" target="_blank">http://w3.org/International/questions/qa-forms-utf-8.html</a><br>&nbsp; &nbsp; </span><span class="keyword">return </span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">'%^(?:<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [\x09\x0A\x0D\x20-\x7E]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # ASCII<br>&nbsp; &nbsp; &nbsp; &nbsp; | [\xC2-\xDF][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; # non-overlong 2-byte<br>&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; \xE0[\xA0-\xBF][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; # excluding overlongs<br>&nbsp; &nbsp; &nbsp; &nbsp; | [\xE1-\xEC\xEE\xEF][\x80-\xBF]{2}&nbsp; # straight 3-byte<br>&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; \xED[\x80-\x9F][\x80-\xBF]&nbsp; &nbsp; &nbsp; &nbsp; # excluding surrogates<br>&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; \xF0[\x90-\xBF][\x80-\xBF]{2}&nbsp; &nbsp;&nbsp; # planes 1-3<br>&nbsp; &nbsp; &nbsp; &nbsp; | [\xF1-\xF3][\x80-\xBF]{3}&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # planes 4-15<br>&nbsp; &nbsp; &nbsp; &nbsp; |&nbsp; \xF4[\x80-\x8F][\x80-\xBF]{2}&nbsp; &nbsp;&nbsp; # plane 16<br>&nbsp; &nbsp; )*$%xs'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br>&nbsp; &nbsp; <br>} </span><span class="comment">// function is_utf8<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="112391">  
  <a class="name">
  <strong class="user"><em>eyecatchup at gmail dot com</em></strong></a><div class="date" title="2013-06-11 10:41"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom112391">
<div class="phpcode"><code><span class="html">
Just a note: Instead of using the often recommended (rather complex) regular expression by W3C (<a rel="nofollow" target="_blank">http://www.w3.org/International/questions/qa-forms-utf-8.en.php</a>), you can simply use the 'u' modifier to test a string for UTF-8 validity:<br><br><span class="default">&lt;?php<br>&nbsp; </span><span class="keyword">if (</span><span class="default">preg_match</span><span class="keyword">(</span><span class="string">"//u"</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">)) {<br>&nbsp; &nbsp; &nbsp; </span><span class="comment">// $string is valid UTF-8<br>&nbsp; </span><span class="keyword">}</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="120905">  
  <a class="name">
  <strong class="user"><em>garbage at iglou dot eu</em></strong></a><div class="date" title="2017-03-30 01:11"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom120905">
<div class="phpcode"><code><span class="html">
For detect UTF-8, you can use:<br><br>if (preg_match('!!u', $str)) { echo 'utf-8'; }<br><br>- Norihiori</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122556">  
  <a class="name">
  <strong class="user"><em>recentUser at example dot com</em></strong></a><div class="date" title="2018-03-28 07:17"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122556">
<div class="phpcode"><code><span class="html">
In my environment (PHP 7.1.12),<br>"mb_detect_encoding()" doesn't work<br>&nbsp; &nbsp;&nbsp; where "mb_detect_order()" is not set appropriately.<br><br>To enable "mb_detect_encoding()" to work in such a case,<br>&nbsp; &nbsp;&nbsp; simply put "mb_detect_order('...')"<br>&nbsp; &nbsp;&nbsp; before "mb_detect_encoding()" in your script file.<br><br>Both <br>&nbsp; &nbsp;&nbsp; "ini_set('mbstring.language', '...');"<br>&nbsp; &nbsp;&nbsp; and<br>&nbsp; &nbsp;&nbsp; "ini_set('mbstring.detect_order', '...');"<br>DON'T work in script files for this purpose<br>whereas setting them in PHP.INI file may work.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="55228">  
  <a class="name">
  <strong class="user"><em>telemach</em></strong></a><div class="date" title="2005-07-27 06:48"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom55228">
<div class="phpcode"><code><span class="html">
beware : even if you need to distinguish between UTF-8 and ISO-8859-1, and you the following detection order (as chrigu suggests)<br><br>mb_detect_encoding('accentu\xE9e' , 'UTF-8, ISO-8859-1')<br><br>returns ISO-8859-1, while <br><br>mb_detect_encoding('accentu\xE9' , 'UTF-8, ISO-8859-1')<br><br>returns UTF-8<br><br>bottom line : an ending '\xE9' (and probably other accentuated chars) mislead mb_detect_encoding</span>
</code></div>
  </div>
 </div>
  <div class="note" id="113983">  
  <a class="name">
  <strong class="user"><em>emoebel at web dot de</em></strong></a><div class="date" title="2013-12-25 09:29"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom113983">
<div class="phpcode"><code><span class="html">
if the&nbsp; function " mb_detect_encoding" does not exist&nbsp; ... <br><br>... try: <br><br><span class="default">&lt;?php <br></span><span class="comment">// ---------------------------------------------------- <br></span><span class="keyword">if ( !</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'mb_detect_encoding'</span><span class="keyword">) ) { <br><br></span><span class="comment">// ---------------------------------------------------------------- <br></span><span class="keyword">function </span><span class="default">mb_detect_encoding </span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$enc</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">, </span><span class="default">$ret</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) { <br>&nbsp; &nbsp; &nbsp;&nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; static </span><span class="default">$enclist </span><span class="keyword">= array( <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII'</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'ISO-8859-1'</span><span class="keyword">, </span><span class="string">'ISO-8859-2'</span><span class="keyword">, </span><span class="string">'ISO-8859-3'</span><span class="keyword">, </span><span class="string">'ISO-8859-4'</span><span class="keyword">, </span><span class="string">'ISO-8859-5'</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'ISO-8859-6'</span><span class="keyword">, </span><span class="string">'ISO-8859-7'</span><span class="keyword">, </span><span class="string">'ISO-8859-8'</span><span class="keyword">, </span><span class="string">'ISO-8859-9'</span><span class="keyword">, </span><span class="string">'ISO-8859-10'</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'ISO-8859-13'</span><span class="keyword">, </span><span class="string">'ISO-8859-14'</span><span class="keyword">, </span><span class="string">'ISO-8859-15'</span><span class="keyword">, </span><span class="string">'ISO-8859-16'</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="string">'Windows-1251'</span><span class="keyword">, </span><span class="string">'Windows-1252'</span><span class="keyword">, </span><span class="string">'Windows-1254'</span><span class="keyword">, <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$result </span><span class="keyword">= </span><span class="default">false</span><span class="keyword">; <br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; foreach (</span><span class="default">$enclist </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sample </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">); <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$sample</span><span class="keyword">) == </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$ret </span><span class="keyword">=== </span><span class="default">NULL</span><span class="keyword">) { </span><span class="default">$result </span><span class="keyword">= </span><span class="default">$item</span><span class="keyword">; } else { </span><span class="default">$result </span><span class="keyword">= </span><span class="default">true</span><span class="keyword">; } <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break; <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; return </span><span class="default">$result</span><span class="keyword">; <br>} <br></span><span class="comment">// ---------------------------------------------------------------- <br><br></span><span class="keyword">} <br></span><span class="comment">// ---------------------------------------------------- <br></span><span class="default">?&gt;<br></span><br>example / usage of: mb_detect_encoding() <br><br><span class="default">&lt;?php <br></span><span class="comment">// ------------------------------------------------------ <br></span><span class="keyword">function </span><span class="default">str_to_utf8 </span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">) { <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if (</span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">, </span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">) === </span><span class="default">false</span><span class="keyword">) { <br>&nbsp; &nbsp; </span><span class="default">$str </span><span class="keyword">= </span><span class="default">utf8_encode</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">); <br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; return </span><span class="default">$str</span><span class="keyword">;<br>}<br></span><span class="comment">// ------------------------------------------------------ <br></span><span class="default">?&gt;<br></span><br>$txtstr = str_to_utf8($txtstr);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="111747">  
  <a class="name">
  <strong class="user"><em>bmrkbyet at web dot de</em></strong></a><div class="date" title="2013-03-24 02:04"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom111747">
<div class="phpcode"><code><span class="html">
a) if the FUNCTION mb_detect_encoding is not available: <br><br>### mb_detect_encoding ... iconv ###<br><br><span class="default">&lt;?php<br></span><span class="comment">// -------------------------------------------<br><br></span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'mb_detect_encoding'</span><span class="keyword">)) { <br>function </span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$enc</span><span class="keyword">=</span><span class="default">null</span><span class="keyword">) { <br>&nbsp; &nbsp; <br>&nbsp; &nbsp; static </span><span class="default">$list </span><span class="keyword">= array(</span><span class="string">'utf-8'</span><span class="keyword">, </span><span class="string">'iso-8859-1'</span><span class="keyword">, </span><span class="string">'windows-1251'</span><span class="keyword">);<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; foreach (</span><span class="default">$list </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) {<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$sample </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br>&nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$sample</span><span class="keyword">) == </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">)) { <br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (</span><span class="default">$enc </span><span class="keyword">== </span><span class="default">$item</span><span class="keyword">) { return </span><span class="default">true</span><span class="keyword">; }&nbsp; &nbsp; else { return </span><span class="default">$item</span><span class="keyword">; } <br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; return </span><span class="default">null</span><span class="keyword">;<br>}<br>}<br><br></span><span class="comment">// -------------------------------------------<br></span><span class="default">?&gt;<br></span><br>b) if the FUNCTION mb_convert_encoding is not available: <br><br>### mb_convert_encoding ... iconv ###<br><br><span class="default">&lt;?php<br></span><span class="comment">// -------------------------------------------<br><br></span><span class="keyword">if(!</span><span class="default">function_exists</span><span class="keyword">(</span><span class="string">'mb_convert_encoding'</span><span class="keyword">)) { <br>function </span><span class="default">mb_convert_encoding</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">, </span><span class="default">$target_encoding</span><span class="keyword">, </span><span class="default">$source_encoding</span><span class="keyword">) { <br>&nbsp; &nbsp; </span><span class="default">$string </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$source_encoding</span><span class="keyword">, </span><span class="default">$target_encoding</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">); <br>&nbsp; &nbsp; return </span><span class="default">$string</span><span class="keyword">; <br>}<br>}<br><br></span><span class="comment">// -------------------------------------------<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="48955">  
  <a class="name">
  <strong class="user"><em>maarten</em></strong></a><div class="date" title="2005-01-12 03:55"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom48955">
<div class="phpcode"><code><span class="html">
Sometimes mb_detect_string is not what you need. When using pdflib for example you want to VERIFY the correctness of utf-8. mb_detect_encoding reports some iso-8859-1 encoded text as utf-8.<br>To verify utf 8 use the following:<br><br>//<br>//&nbsp; &nbsp; utf8 encoding validation developed based on Wikipedia entry at:<br>//&nbsp; &nbsp; <a rel="nofollow" target="_blank">http://en.wikipedia.org/wiki/UTF-8</a><br>//<br>//&nbsp; &nbsp; Implemented as a recursive descent parser based on a simple state machine<br>//&nbsp; &nbsp; copyright 2005 Maarten Meijer<br>//<br>//&nbsp; &nbsp; This cries out for a C-implementation to be included in PHP core<br>//<br>&nbsp; &nbsp; function valid_1byte($char) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!is_int($char)) return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; return ($char &amp; 0x80) == 0x00;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function valid_2byte($char) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!is_int($char)) return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; return ($char &amp; 0xE0) == 0xC0;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function valid_3byte($char) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!is_int($char)) return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; return ($char &amp; 0xF0) == 0xE0;<br>&nbsp; &nbsp; }<br><br>&nbsp; &nbsp; function valid_4byte($char) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!is_int($char)) return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; return ($char &amp; 0xF8) == 0xF0;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function valid_nextbyte($char) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if(!is_int($char)) return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; return ($char &amp; 0xC0) == 0x80;<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; function valid_utf8($string) {<br>&nbsp; &nbsp; &nbsp; &nbsp; $len = strlen($string);<br>&nbsp; &nbsp; &nbsp; &nbsp; $i = 0;&nbsp; &nbsp; <br>&nbsp; &nbsp; &nbsp; &nbsp; while( $i &lt; $len ) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $char = ord(substr($string, $i++, 1));<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(valid_1byte($char)) {&nbsp; &nbsp; // continue<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; continue;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if(valid_2byte($char)) { // check 1 byte<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!valid_nextbyte(ord(substr($string, $i++, 1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if(valid_3byte($char)) { // check 2 bytes<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!valid_nextbyte(ord(substr($string, $i++, 1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!valid_nextbyte(ord(substr($string, $i++, 1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } else if(valid_4byte($char)) { // check 3 bytes<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!valid_nextbyte(ord(substr($string, $i++, 1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!valid_nextbyte(ord(substr($string, $i++, 1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if(!valid_nextbyte(ord(substr($string, $i++, 1))))<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } // goto next char<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; &nbsp; &nbsp; return true; // done<br>&nbsp; &nbsp; }<br><br>for a drawing of the statemachine see: <a rel="nofollow" target="_blank">http://www.xs4all.nl/~mjmeijer/unicode.png</a> and <a rel="nofollow" target="_blank">http://www.xs4all.nl/~mjmeijer/unicode2.png</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="113420">  
  <a class="name">
  <strong class="user"><em>Anonymous</em></strong></a><div class="date" title="2013-10-08 09:17"><strong>7 years ago</strong></div>
  <div class="text" id="Hcom113420">
<div class="phpcode"><code><span class="html">
// ----------------------------------------------------------- <br><br>if(!function_exists('mb_detect_encoding')) {<br><br>function mb_detect_encoding($string, $enc=null, $ret=true) {<br>&nbsp; &nbsp; $out=$enc; <br>&nbsp; &nbsp; static $list = array('utf-8', 'iso-8859-1', 'iso-8859-15', 'windows-1251');<br>&nbsp; &nbsp; &nbsp; &nbsp; foreach ($list as $item) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $sample = iconv($item, $item, $string);<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (md5($sample) == md5($string)) { $out = ($ret !== false) ? true : $item; } <br>&nbsp; &nbsp; &nbsp; &nbsp; } <br>&nbsp; &nbsp; return $out;<br>}<br><br>}<br><br>// -----------------------------------------------------------</span>
</code></div>
  </div>
 </div>
  <div class="note" id="122227">  
  <a class="name">
  <strong class="user"><em>lotushzy at gmail dot com</em></strong></a><div class="date" title="2018-01-04 12:18"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom122227">
<div class="phpcode"><code><span class="html">
About function mb_detect_encoding, the link <a rel="nofollow" target="_blank">http://php.net/manual/zh/function.mb-detect-encoding.php</a> , like this:<br>mb_detect_encoding('áéóú', 'UTF-8', true); // false<br>but now the result is not false, can you give me reason, thanks!</span>
</code></div>
  </div>
 </div>
  <div class="note" id="84592">  
  <a class="name">
  <strong class="user"><em>yaqy at qq dot com</em></strong></a><div class="date" title="2008-07-20 10:14"><strong>13 years ago</strong></div>
  <div class="text" id="Hcom84592">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php
<br></span><span class="comment">/*
<br>*QQ: 290359552
<br>* conver to Utf8 if $str is not equals to 'UTF-8'
<br>*/
<br></span><span class="keyword">function </span><span class="default">convToUtf8</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">)
<br>{
<br>if( </span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$str</span><span class="keyword">,</span><span class="string">"UTF-8, ISO-8859-1, GBK"</span><span class="keyword">)!=</span><span class="string">"UTF-8" </span><span class="keyword">)
<br>{
<br>
<br>return&nbsp; </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">"gbk"</span><span class="keyword">,</span><span class="string">"utf-8"</span><span class="keyword">,</span><span class="default">$str</span><span class="keyword">);
<br>
<br>}
<br>else
<br>{
<br>return </span><span class="default">$str</span><span class="keyword">;
<br>}
<br>
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="120125">  
  <a class="name">
  <strong class="user"><em>lexonight at yahoo dot com</em></strong></a><div class="date" title="2016-11-06 12:54"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom120125">
<div class="phpcode"><code><span class="html">
<span class="default">&lt;?php<br>$file </span><span class="keyword">= </span><span class="default">file_get_contents</span><span class="keyword">(</span><span class="string">"somefile.txt"</span><span class="keyword">);<br></span><span class="default">$encodings </span><span class="keyword">= </span><span class="default">implode</span><span class="keyword">(</span><span class="string">','</span><span class="keyword">, </span><span class="default">mb_list_encodings</span><span class="keyword">());<br>echo </span><span class="default">mb_detect_encoding</span><span class="keyword">(</span><span class="default">$file</span><span class="keyword">, </span><span class="default">$encodings</span><span class="keyword">, </span><span class="default">true</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span>seems to work</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89915">  
  <a class="name">
  <strong class="user"><em>matthijs at ischen dot nl</em></strong></a><div class="date" title="2009-03-28 10:33"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom89915">
<div class="phpcode"><code><span class="html">
I seriously underestimated the importance of setlocale...<br><span class="default">&lt;?php<br>$strings </span><span class="keyword">= array(<br>&nbsp; &nbsp; </span><span class="string">"mais coisas a pensar sobre diário ou dois!"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"plus de choses à penser à journalier ou à deux !"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"¡más cosas a pensar en diario o dos!"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"più cose da pensare circa giornaliere o due!"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"flere ting å tenke på hver dag eller to!"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"Další věcí, přemýšlet o každý den nebo dva!"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"mehr über Spaß spät schönen"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"më vonë gjatë fun bukur"</span><span class="keyword">,<br>&nbsp; &nbsp; </span><span class="string">"több mint szórakozás késő csodálatos kenyér"<br></span><span class="keyword">);<br><br></span><span class="default">$convert </span><span class="keyword">= array();<br></span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'de_DE.UTF-8'</span><span class="keyword">);<br>foreach( </span><span class="default">$strings </span><span class="keyword">as </span><span class="default">$string </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$convert</span><span class="keyword">[] = </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT//IGNORE'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>Produces the following: <br><br>Array<br>(<br>&nbsp; &nbsp; [0] =&gt; mais coisas a pensar sobre diario ou dois!<br>&nbsp; &nbsp; [1] =&gt; plus de choses a penser a journalier ou a deux !<br>&nbsp; &nbsp; [2] =&gt; ?mas cosas a pensar en diario o dos!<br>&nbsp; &nbsp; [3] =&gt; piu cose da pensare circa giornaliere o due!<br>&nbsp; &nbsp; [4] =&gt; flere ting aa tenke paa hver dag eller to!<br>&nbsp; &nbsp; [5] =&gt; Dalsi veci, premyslet o kazdy den nebo dva!<br>&nbsp; &nbsp; [6] =&gt; mehr ueber Spass spaet schoenen<br>&nbsp; &nbsp; [7] =&gt; me vone gjate fun bukur<br>&nbsp; &nbsp; [8] =&gt; toebb mint szorakozas keso csodalatos kenyer<br>)<br><br>whereas <br><br><span class="default">&lt;?php<br>$convert </span><span class="keyword">= array();<br></span><span class="default">setlocale</span><span class="keyword">(</span><span class="default">LC_CTYPE</span><span class="keyword">, </span><span class="string">'nl_NL.UTF-8'</span><span class="keyword">);<br>foreach( </span><span class="default">$strings </span><span class="keyword">as </span><span class="default">$string </span><span class="keyword">)<br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="default">$convert</span><span class="keyword">[] = </span><span class="default">iconv</span><span class="keyword">(</span><span class="string">'UTF-8'</span><span class="keyword">, </span><span class="string">'ASCII//TRANSLIT//IGNORE'</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br></span><span class="default">?&gt;<br></span><br>produces:<br>Array<br>(<br>&nbsp; &nbsp; [0] =&gt; mais coisas a pensar sobre di?rio ou dois!<br>&nbsp; &nbsp; [1] =&gt; plus de choses ? penser ? journalier ou ? deux !<br>&nbsp; &nbsp; [2] =&gt; ?m?s cosas a pensar en diario o dos!<br>&nbsp; &nbsp; [3] =&gt; pi? cose da pensare circa giornaliere o due!<br>&nbsp; &nbsp; [4] =&gt; flere ting ? tenke p? hver dag eller to!<br>&nbsp; &nbsp; [5] =&gt; Dal?? v?c?, p?em??let o ka?d? den nebo dva!<br>&nbsp; &nbsp; [6] =&gt; mehr ?ber Spass sp?t sch?nen<br>&nbsp; &nbsp; [7] =&gt; m? von? gjat? fun bukur<br>&nbsp; &nbsp; [8] =&gt; t?bb mint sz?rakoz?s k?s? csod?latos keny?r<br>)<br><br>This might be of interest when trying to convert utf-8 strings into ASCII suitable for URL's, and such. this was never obvious for me since I've used locales for us and nl.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="49000">  
  <a class="name">
  <strong class="user"><em>jaaks at playtech dot com</em></strong></a><div class="date" title="2005-01-14 12:27"><strong>16 years ago</strong></div>
  <div class="text" id="Hcom49000">
<div class="phpcode"><code><span class="html">
Last example for verifying UTF-8 has one little bug. If 10xxxxxx byte occurs alone i.e. not in multibyte char, then it is accepted although it is against UTF-8 rules. Make following replacement to repair it.<br><br>Replace<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } // goto next char<br>with<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; return false; // 10xxxxxx occuring alone<br>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; } // goto next char</span>
</code></div>
  </div>
 </div>
  <div class="note" id="89944">  
  <a class="name">
  <strong class="user"><em>prgss at bk dot ru</em></strong></a><div class="date" title="2009-03-30 02:16"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom89944">
<div class="phpcode"><code><span class="html">
Another light way to detect character encoding:<br><span class="default">&lt;?php<br></span><span class="keyword">function </span><span class="default">detect_encoding</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">) {&nbsp; <br>&nbsp; static </span><span class="default">$list </span><span class="keyword">= array(</span><span class="string">'utf-8'</span><span class="keyword">, </span><span class="string">'windows-1251'</span><span class="keyword">);<br>&nbsp; <br>&nbsp; foreach (</span><span class="default">$list </span><span class="keyword">as </span><span class="default">$item</span><span class="keyword">) {<br>&nbsp; &nbsp; </span><span class="default">$sample </span><span class="keyword">= </span><span class="default">iconv</span><span class="keyword">(</span><span class="default">$item</span><span class="keyword">, </span><span class="default">$item</span><span class="keyword">, </span><span class="default">$string</span><span class="keyword">);<br>&nbsp; &nbsp; if (</span><span class="default">md5</span><span class="keyword">(</span><span class="default">$sample</span><span class="keyword">) == </span><span class="default">md5</span><span class="keyword">(</span><span class="default">$string</span><span class="keyword">))<br>&nbsp; &nbsp; &nbsp; return </span><span class="default">$item</span><span class="keyword">;<br>&nbsp; }<br>&nbsp; return </span><span class="default">null</span><span class="keyword">;<br>}<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="68893">  
  <a class="name">
  <strong class="user"><em>sunggsun</em></strong></a><div class="date" title="2006-08-15 12:26"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom68893">
<div class="phpcode"><code><span class="html">
from PHPDIG<br><br>&nbsp; &nbsp; function isUTF8($str) {<br>&nbsp; &nbsp; &nbsp; &nbsp; if ($str === mb_convert_encoding(mb_convert_encoding($str, "UTF-32", "UTF-8"), "UTF-8", "UTF-32")) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return true;<br>&nbsp; &nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return false;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.mb-detect-encoding.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 06:11:05 GMT -->

</body></html>