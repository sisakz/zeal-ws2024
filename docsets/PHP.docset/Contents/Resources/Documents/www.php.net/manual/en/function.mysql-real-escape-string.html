<html><!-- Mirrored from www.php.net/manual/en/function.mysql-real-escape-string.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 05:47:22 GMT --><!-- Added by HTTrack --><head><meta http-equiv="content-type" content="text/html;charset=utf-8"><!-- /Added by HTTrack -->


  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>mysql_real_escape_string</title>

 <link rel="shortcut icon" href="../../favicon.ico">
 <link rel="search" type="application/opensearchdescription+xml" href="http://php.net/phpnetimprovedsearch.src" title="Add PHP.net search">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/releases/feed.php" title="PHP Release feed">
 <link rel="alternate" type="application/atom+xml" href="https://www.php.net/feed.atom" title="PHP: Hypertext Preprocessor">

 <link rel="canonical" href="function.mysql-real-escape-string.html">
 <link rel="shorturl" href="https://www.php.net/mysql-real-escape-string">
 <link rel="alternate" href="https://www.php.net/mysql-real-escape-string" hreflang="x-default">

 <link rel="contents" href="index-2.html">
 <link rel="index" href="ref.mysql.html">
 <link rel="prev" href="function.mysql-query.html">
 <link rel="next" href="function.mysql-result.html">

 <link rel="alternate" href="function.mysql-real-escape-string.html" hreflang="en">
 <link rel="alternate" href="https://www.php.net/manual/pt_BR/function.mysql-real-escape-string.php" hreflang="pt_BR">
 <link rel="alternate" href="https://www.php.net/manual/zh/function.mysql-real-escape-string.php" hreflang="zh">
 <link rel="alternate" href="https://www.php.net/manual/fr/function.mysql-real-escape-string.php" hreflang="fr">
 <link rel="alternate" href="https://www.php.net/manual/de/function.mysql-real-escape-string.php" hreflang="de">
 <link rel="alternate" href="https://www.php.net/manual/ja/function.mysql-real-escape-string.php" hreflang="ja">
 <link rel="alternate" href="https://www.php.net/manual/ro/function.mysql-real-escape-string.php" hreflang="ro">
 <link rel="alternate" href="https://www.php.net/manual/ru/function.mysql-real-escape-string.php" hreflang="ru">
 <link rel="alternate" href="https://www.php.net/manual/es/function.mysql-real-escape-string.php" hreflang="es">
 <link rel="alternate" href="https://www.php.net/manual/tr/function.mysql-real-escape-string.php" hreflang="tr">

<link rel="stylesheet" type="text/css" href="../../cached0aba.css?t=1539771603&amp;f=/fonts/Fira/fira.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached2ecf.css?t=1539765004&amp;f=/fonts/Font-Awesome/css/fontello.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cachedba57.css?t=1606338002&amp;f=/styles/theme-base.css" media="screen">
<link rel="stylesheet" type="text/css" href="../../cached3afa.css?t=1627831203&amp;f=/styles/theme-medium.css" media="screen">

 <!--[if lte IE 7]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie7.css" media="screen">
 <![endif]-->

 <!--[if lte IE 8]>
 <script>
  window.brokenIE = true;
 </script>
 <![endif]-->

 <!--[if lte IE 9]>
 <link rel="stylesheet" type="text/css" href="https://www.php.net/styles/workarounds.ie9.css" media="screen">
 <![endif]-->

 <!--[if IE]>
 <script src="https://www.php.net/js/ext/html5.js"></script>
 <![endif]-->

 <base>


</head>
<body class="docs " style="">


<div class="headsup"><a href="https://www.php.net/conferences/index.php#id2021-09-08-1">Longhorn PHP 2021</a></div>
<nav id="trick"><div><dl>
<dt><a href="getting-started.html">Getting Started</a></dt>
	<dd><a href="introduction.html">Introduction</a></dd>
	<dd><a href="tutorial.html">A simple tutorial</a></dd>
<dt><a href="langref.html">Language Reference</a></dt>
	<dd><a href="language.basic-syntax.html">Basic syntax</a></dd>
	<dd><a href="language.types.html">Types</a></dd>
	<dd><a href="language.variables.html">Variables</a></dd>
	<dd><a href="language.constants.html">Constants</a></dd>
	<dd><a href="language.expressions.html">Expressions</a></dd>
	<dd><a href="language.operators.html">Operators</a></dd>
	<dd><a href="language.control-structures.html">Control Structures</a></dd>
	<dd><a href="language.functions.html">Functions</a></dd>
	<dd><a href="language.oop5.html">Classes and Objects</a></dd>
	<dd><a href="language.namespaces.html">Namespaces</a></dd>
	<dd><a href="language.errors.html">Errors</a></dd>
	<dd><a href="language.exceptions.html">Exceptions</a></dd>
	<dd><a href="language.generators.html">Generators</a></dd>
	<dd><a href="language.attributes.html">Attributes</a></dd>
	<dd><a href="language.references.html">References Explained</a></dd>
	<dd><a href="reserved.variables.html">Predefined Variables</a></dd>
	<dd><a href="reserved.exceptions.html">Predefined Exceptions</a></dd>
	<dd><a href="reserved.interfaces.html">Predefined Interfaces and Classes</a></dd>
	<dd><a href="context.html">Context options and parameters</a></dd>
	<dd><a href="wrappers.html">Supported Protocols and Wrappers</a></dd>
</dl>
<dl>
<dt><a href="security.html">Security</a></dt>
	<dd><a href="security.intro.html">Introduction</a></dd>
	<dd><a href="security.general.html">General considerations</a></dd>
	<dd><a href="security.cgi-bin.html">Installed as CGI binary</a></dd>
	<dd><a href="security.apache.html">Installed as an Apache module</a></dd>
	<dd><a href="security.sessions.html">Session Security</a></dd>
	<dd><a href="security.filesystem.html">Filesystem Security</a></dd>
	<dd><a href="security.database.html">Database Security</a></dd>
	<dd><a href="security.errors.html">Error Reporting</a></dd>
	<dd><a href="security.variables.html">User Submitted Data</a></dd>
	<dd><a href="security.hiding.html">Hiding PHP</a></dd>
	<dd><a href="security.current.html">Keeping Current</a></dd>
<dt><a href="features.html">Features</a></dt>
	<dd><a href="features.http-auth.html">HTTP authentication with PHP</a></dd>
	<dd><a href="features.cookies.html">Cookies</a></dd>
	<dd><a href="features.sessions.html">Sessions</a></dd>
	<dd><a href="features.xforms.html">Dealing with XForms</a></dd>
	<dd><a href="features.file-upload.html">Handling file uploads</a></dd>
	<dd><a href="features.remote-files.html">Using remote files</a></dd>
	<dd><a href="features.connection-handling.html">Connection handling</a></dd>
	<dd><a href="features.persistent-connections.html">Persistent Database Connections</a></dd>
	<dd><a href="features.commandline.html">Command line usage</a></dd>
	<dd><a href="features.gc.html">Garbage Collection</a></dd>
	<dd><a href="features.dtrace.html">DTrace Dynamic Tracing</a></dd>
</dl>
<dl>
<dt><a href="funcref.html">Function Reference</a></dt>
	<dd><a href="refs.basic.php.html">Affecting PHP's Behaviour</a></dd>
	<dd><a href="refs.utilspec.audio.html">Audio Formats Manipulation</a></dd>
	<dd><a href="refs.remote.auth.html">Authentication Services</a></dd>
	<dd><a href="refs.utilspec.cmdline.html">Command Line Specific Extensions</a></dd>
	<dd><a href="refs.compression.html">Compression and Archive Extensions</a></dd>
	<dd><a href="refs.crypto.html">Cryptography Extensions</a></dd>
	<dd><a href="refs.database.html">Database Extensions</a></dd>
	<dd><a href="refs.calendar.html">Date and Time Related Extensions</a></dd>
	<dd><a href="refs.fileprocess.file.html">File System Related Extensions</a></dd>
	<dd><a href="refs.international.html">Human Language and Character Encoding Support</a></dd>
	<dd><a href="refs.utilspec.image.html">Image Processing and Generation</a></dd>
	<dd><a href="refs.remote.mail.html">Mail Related Extensions</a></dd>
	<dd><a href="refs.math.html">Mathematical Extensions</a></dd>
	<dd><a href="refs.utilspec.nontext.html">Non-Text MIME Output</a></dd>
	<dd><a href="refs.fileprocess.process.html">Process Control Extensions</a></dd>
	<dd><a href="refs.basic.other.html">Other Basic Extensions</a></dd>
	<dd><a href="refs.remote.other.html">Other Services</a></dd>
	<dd><a href="refs.search.html">Search Engine Extensions</a></dd>
	<dd><a href="refs.utilspec.server.html">Server Specific Extensions</a></dd>
	<dd><a href="refs.basic.session.html">Session Extensions</a></dd>
	<dd><a href="refs.basic.text.html">Text Processing</a></dd>
	<dd><a href="refs.basic.vartype.html">Variable and Type Related Extensions</a></dd>
	<dd><a href="refs.webservice.html">Web Services</a></dd>
	<dd><a href="refs.utilspec.windows.html">Windows Only Extensions</a></dd>
	<dd><a href="refs.xml.html">XML Manipulation</a></dd>
	<dd><a href="refs.ui.html">GUI Extensions</a></dd>
</dl>
<dl>
<dt>Keyboard Shortcuts</dt><dt>?</dt>
<dd>This help</dd>
<dt>j</dt>
<dd>Next menu item</dd>
<dt>k</dt>
<dd>Previous menu item</dd>
<dt>g p</dt>
<dd>Previous man page</dd>
<dt>g n</dt>
<dd>Next man page</dd>
<dt>G</dt>
<dd>Scroll to bottom</dd>
<dt>g g</dt>
<dd>Scroll to top</dd>
<dt>g h</dt>
<dd>Goto homepage</dd>
<dt>g s</dt>
<dd>Goto search<br>(current page)</dd>
<dt>/</dt>
<dd>Focus search box</dd>
</dl></div></nav>
<div id="goto">
    <div class="search">
         <div class="text"></div>
         <div class="results"><ul></ul></div>
   </div>
</div>

  <div id="breadcrumbs" class="row-fluid">
    <div id="breadcrumbs-inner">
          
              
          <ul>
            <li><a href="index-2.html">PHP Manual</a></li>      <li><a href="funcref.html">Function Reference</a></li>      <li><a href="refs.database.html">Database Extensions</a></li>      <li><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>      <li><a href="set.mysqlinfo.html">MySQL</a></li>      <li><a href="book.mysql.html">MySQL (Original)</a></li>      <li><a href="ref.mysql.html">MySQL Functions</a></li>      </ul>
    </div>
  </div>




<div id="layout" class="clearfix">
  <section id="layout-content">
  <div id="function.mysql-real-escape-string" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">mysql_real_escape_string</h1>
  <p class="verinfo">(PHP 4 &gt;= 4.3.0, PHP 5)</p><p class="refpurpose"><span class="refname">mysql_real_escape_string</span> â€” <span class="dc-title">Escapes special characters in a string for use in an SQL statement</span></p>

 </div>

 <div id="function.mysql-real-escape-string-refsynopsisdiv">
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="para">This extension was deprecated in PHP 5.5.0, and it was removed in PHP 7.0.0.
Instead, the <a href="book.mysqli.html" class="link">MySQLi</a> or <a href="ref.pdo-mysql.html" class="link">PDO_MySQL</a> extension should be used.
See also <a href="mysqlinfo.api.choosing.html" class="link">MySQL: choosing an API</a> guide.
Alternatives to this function include:</p>
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="mysqli.real-escape-string.html" class="function">mysqli_real_escape_string()</a></span></li>
    <li class="member"><span class="methodname"><a href="pdo.quote.html" class="methodname">PDO::quote()</a></span></li>
   </ul>
  </div>
 </div>

 <div class="refsect1 description" id="refsect1-function.mysql-real-escape-string-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>mysql_real_escape_string</strong></span>(<span class="methodparam"><span class="type">string</span> <code class="parameter">$unescaped_string</code></span>, <span class="methodparam"><span class="type">resource</span> <code class="parameter">$link_identifier</code><span class="initializer"> = NULL</span></span>): <span class="type">string</span></div>

  <p class="para rdfs-comment">
   Escapes special characters in the <code class="parameter">unescaped_string</code>, 
   taking into account the current character set of the connection so that it 
   is safe to place it in a <span class="function"><a href="function.mysql-query.html" class="function">mysql_query()</a></span>. If binary data 
   is to be inserted, this function must be used.
  </p>
  <p class="para">
   <span class="function"><strong>mysql_real_escape_string()</strong></span> calls MySQL's library function
   mysql_real_escape_string, which prepends backslashes to the following characters:
   <code class="literal">\x00</code>, <code class="literal">\n</code>,
   <code class="literal">\r</code>, <code class="literal">\</code>, <code class="literal">'</code>,
   <code class="literal">"</code> and <code class="literal">\x1a</code>.
  </p>
  <p class="para">
   This function must always (with few exceptions) be used to make data
   safe before sending a query to MySQL.
  </p>
  
  <div class="caution"><strong class="caution">Caution</strong>
   <h1 class="title">Security: the default character set</h1>
   <p class="para">
    The character set must be set either at the server level, or with
    the API function <span class="function"><a href="function.mysql-set-charset.html" class="function">mysql_set_charset()</a></span> for it to affect
    <span class="function"><strong>mysql_real_escape_string()</strong></span>. See the concepts section
    on <a href="mysqlinfo.concepts.charset.html" class="link">character sets</a> for
    more information.
   </p>
  </div>
 </div>


 <div class="refsect1 parameters" id="refsect1-function.mysql-real-escape-string-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   </p><dl>
    
     <dt>
<code class="parameter">unescaped_string</code></dt>

     <dd>

      <p class="para">
       The string that is to be escaped.
      </p>
     </dd>

    
    <dt>
<code class="parameter">
link_identifier</code></dt>
<dd>
<p class="para">The MySQL connection. If the
link identifier is not specified, the last link opened by
<span class="function"><a href="function.mysql-connect.html" class="function">mysql_connect()</a></span> is assumed. If no such link is found, it
will try to create one as if <span class="function"><a href="function.mysql-connect.html" class="function">mysql_connect()</a></span> had been called
with no arguments. If no connection is found or established, an
<strong><code>E_WARNING</code></strong> level error is generated.</p></dd>


   </dl>

  <p></p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-function.mysql-real-escape-string-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   Returns the escaped string, or <strong><code>false</code></strong> on error.
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-function.mysql-real-escape-string-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   Executing this function without a MySQL connection present will
   also emit <strong><code>E_WARNING</code></strong> level PHP errors. Only
   execute this function with a valid MySQL connection present.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.mysql-real-escape-string-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   </p><div class="example" id="example-1712">
    <p><strong>Example #1 Simple <span class="function"><strong>mysql_real_escape_string()</strong></span> example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;Connect<br></span><span style="color: #0000BB">$link&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'mysql_host'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'mysql_user'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'mysql_password'</span><span style="color: #007700">)<br>&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;die(</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">());<br><br></span><span style="color: #FF8000">//&nbsp;Query<br></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">sprintf</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;users&nbsp;WHERE&nbsp;user='%s'&nbsp;AND&nbsp;password='%s'"</span><span style="color: #007700">,<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mysql_real_escape_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">mysql_real_escape_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$password</span><span style="color: #007700">));<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-1713">
    <p><strong>Example #2 <span class="function"><strong>mysql_real_escape_string()</strong></span> requires a connection example</strong></p>
    <div class="example-contents"><p>
     This example demonstrates what happens if a MySQL connection is not
     present when calling this function.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;We&nbsp;have&nbsp;not&nbsp;connected&nbsp;to&nbsp;MySQL<br><br></span><span style="color: #0000BB">$lastname&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"O'Reilly"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$_lastname&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mysql_real_escape_string</span><span style="color: #007700">(</span><span style="color: #0000BB">$lastname</span><span style="color: #007700">);<br><br></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;actors&nbsp;WHERE&nbsp;last_name&nbsp;=&nbsp;'</span><span style="color: #0000BB">$_lastname</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br><br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$_lastname</span><span style="color: #007700">);<br></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>The above example will output
something similar to:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>Warning: mysql_real_escape_string(): No such file or directory in /this/test/script.php on line 5
Warning: mysql_real_escape_string(): A link to the server could not be established in /this/test/script.php on line 5

bool(false)
string(41) "SELECT * FROM actors WHERE last_name = ''"
</pre></div>
    </div>
   </div>
  <p></p>
  <p class="para">
   </p><div class="example" id="example-1714">
    <p><strong>Example #3 An example SQL Injection Attack</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br></span><span style="color: #FF8000">//&nbsp;We&nbsp;didn't&nbsp;check&nbsp;$_POST['password'],&nbsp;it&nbsp;could&nbsp;be&nbsp;anything&nbsp;the&nbsp;user&nbsp;wanted!&nbsp;For&nbsp;example:<br></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'aidan'</span><span style="color: #007700">;<br></span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'password'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">"'&nbsp;OR&nbsp;''='"</span><span style="color: #007700">;<br><br></span><span style="color: #FF8000">//&nbsp;Query&nbsp;database&nbsp;to&nbsp;check&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;matching&nbsp;users<br></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;users&nbsp;WHERE&nbsp;user='</span><span style="color: #007700">{</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'username'</span><span style="color: #007700">]}</span><span style="color: #DD0000">'&nbsp;AND&nbsp;password='</span><span style="color: #007700">{</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">[</span><span style="color: #DD0000">'password'</span><span style="color: #007700">]}</span><span style="color: #DD0000">'"</span><span style="color: #007700">;<br></span><span style="color: #0000BB">mysql_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br><br></span><span style="color: #FF8000">//&nbsp;This&nbsp;means&nbsp;the&nbsp;query&nbsp;sent&nbsp;to&nbsp;MySQL&nbsp;would&nbsp;be:<br></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">$query</span><span style="color: #007700">;<br></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

     <div class="example-contents"><p>
      The query sent to MySQL:
     </p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>SELECT * FROM users WHERE user='aidan' AND password='' OR ''=''
</pre></div>
    </div>
    <div class="example-contents"><p>
     This would allow anyone to log in without a valid password.
    </p></div>
   </div>
  <p></p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.mysql-real-escape-string-notes">
  <h3 class="title">Notes</h3>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    A MySQL connection is required before using 
    <span class="function"><strong>mysql_real_escape_string()</strong></span> otherwise an error of
    level <strong><code>E_WARNING</code></strong> is generated, and <strong><code>false</code></strong> is 
    returned. If <code class="parameter">link_identifier</code> isn't defined, the
    last MySQL connection is used.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    If <a href="info.configuration.html#ini.magic-quotes-gpc" class="link">magic_quotes_gpc</a> is enabled,
    first apply <span class="function"><a href="function.stripslashes.html" class="function">stripslashes()</a></span> to the data. Using this function
    on data which has already been escaped will escape the data twice.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   </p><p class="para">
    If this function is not used to escape data, the query is vulnerable to
    <a href="security.database.sql-injection.html" class="link">SQL Injection Attacks</a>.
   </p>
  <p></p></blockquote>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <span class="simpara">
    <span class="function"><strong>mysql_real_escape_string()</strong></span> does not escape
    <code class="literal">%</code> and <code class="literal">_</code>. These are wildcards in
    MySQL if combined with <code class="literal">LIKE</code>, <code class="literal">GRANT</code>,
    or <code class="literal">REVOKE</code>.
   </span>
  </p></blockquote>
 </div>


 <div class="refsect1 seealso" id="refsect1-function.mysql-real-escape-string-seealso">
  <h3 class="title">See Also</h3>
  <p class="para">
   </p><ul class="simplelist">
    <li class="member"><span class="function"><a href="function.mysql-set-charset.html" class="function" rel="rdfs-seeAlso">mysql_set_charset()</a> - Sets the client character set</span></li>
    <li class="member"><span class="function"><a href="function.mysql-client-encoding.html" class="function" rel="rdfs-seeAlso">mysql_client_encoding()</a> - Returns the name of the character set</span></li>
    <li class="member"><span class="function"><a href="function.addslashes.html" class="function" rel="rdfs-seeAlso">addslashes()</a> - Quote string with slashes</span></li>
    <li class="member"><span class="function"><a href="function.stripslashes.html" class="function" rel="rdfs-seeAlso">stripslashes()</a> - Un-quotes a quoted string</span></li>
    <li class="member">The <a href="info.configuration.html#ini.magic-quotes-gpc" class="link">magic_quotes_gpc</a> directive</li>
    <li class="member">The <a href="info.configuration.html#ini.magic-quotes-runtime" class="link">magic_quotes_runtime</a> directive</li>
   </ul>
  <p></p>
 </div>

</div>
<section id="usernotes">
 <div class="head"><h3 class="title">User Contributed Notes</h3></div><div id="allnotes">
  <div class="note" id="101248">  
  <a class="name">
  <strong class="user"><em>feedr</em></strong></a><div class="date" title="2010-12-05 08:38"><strong>10 years ago</strong></div>
  <div class="text" id="Hcom101248">
<div class="phpcode"><code><span class="html">
Just a little function which mimics the original mysql_real_escape_string but which doesn't need an active mysql connection. Could be implemented as a static function in a database class. Hope it helps someone.
<br>
<br><span class="default">&lt;?php
<br></span><span class="keyword">function </span><span class="default">mysql_escape_mimic</span><span class="keyword">(</span><span class="default">$inp</span><span class="keyword">) {
<br>&nbsp; &nbsp; if(</span><span class="default">is_array</span><span class="keyword">(</span><span class="default">$inp</span><span class="keyword">))
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">array_map</span><span class="keyword">(</span><span class="default">__METHOD__</span><span class="keyword">, </span><span class="default">$inp</span><span class="keyword">);
<br>
<br>&nbsp; &nbsp; if(!empty(</span><span class="default">$inp</span><span class="keyword">) &amp;&amp; </span><span class="default">is_string</span><span class="keyword">(</span><span class="default">$inp</span><span class="keyword">)) {
<br>&nbsp; &nbsp; &nbsp; &nbsp; return </span><span class="default">str_replace</span><span class="keyword">(array(</span><span class="string">'\\'</span><span class="keyword">, </span><span class="string">"\0"</span><span class="keyword">, </span><span class="string">"\n"</span><span class="keyword">, </span><span class="string">"\r"</span><span class="keyword">, </span><span class="string">"'"</span><span class="keyword">, </span><span class="string">'"'</span><span class="keyword">, </span><span class="string">"\x1a"</span><span class="keyword">), array(</span><span class="string">'\\\\'</span><span class="keyword">, </span><span class="string">'\\0'</span><span class="keyword">, </span><span class="string">'\\n'</span><span class="keyword">, </span><span class="string">'\\r'</span><span class="keyword">, </span><span class="string">"\\'"</span><span class="keyword">, </span><span class="string">'\\"'</span><span class="keyword">, </span><span class="string">'\\Z'</span><span class="keyword">), </span><span class="default">$inp</span><span class="keyword">);
<br>&nbsp; &nbsp; }
<br>
<br>&nbsp; &nbsp; return </span><span class="default">$inp</span><span class="keyword">;
<br>}
<br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="108125">  
  <a class="name">
  <strong class="user"><em>Walter Tross</em></strong></a><div class="date" title="2012-03-30 02:20"><strong>9 years ago</strong></div>
  <div class="text" id="Hcom108125">
<div class="phpcode"><code><span class="html">
For further information:<br><a rel="nofollow" target="_blank">http://dev.mysql.com/doc/refman/5.5/en/mysql-real-escape-string.html</a><br>(replace your MySQL version in the URL)</span>
</code></div>
  </div>
 </div>
  <div class="note" id="66836">  
  <a class="name">
  <strong class="user"><em>nicolas</em></strong></a><div class="date" title="2006-05-30 01:38"><strong>15 years ago</strong></div>
  <div class="text" id="Hcom66836">
<div class="phpcode"><code><span class="html">
Note that mysql_real_escape_string doesn't prepend backslashes to \x00, \n, \r, and and \x1a as mentionned in the documentation, but actually replaces the character with a MySQL acceptable representation for queries (e.g. \n is replaced with the '\n' litteral). (\, ', and " are escaped as documented) This doesn't change how you should use this function, but I think it's good to know.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="110413">  
  <a class="name">
  <strong class="user"><em>sam at numbsafari dot com</em></strong></a><div class="date" title="2012-10-19 05:33"><strong>8 years ago</strong></div>
  <div class="text" id="Hcom110413">
<div class="phpcode"><code><span class="html">
No discussion of escaping is complete without telling everyone that you should basically never use external input to generate interpreted code. This goes for SQL statements, or anything you would call any sort of "eval" function on.
<br>
<br>So, instead of using this terribly broken function, use parametric prepared statements instead.
<br>
<br>Honestly, using user provided data to compose SQL statements should be considered professional negligence and you should be held accountable by your employer or client for not using parametric prepared statements.
<br>
<br>What does that mean?
<br>
<br>It means instead of building a SQL statement like this:
<br>
<br>"INSERT INTO X (A) VALUES(".$_POST["a"].")"
<br>
<br>You should use mysqli's prepare() function (<a rel="nofollow" target="_blank">http://php.net/manual/en/mysqli.prepare.php</a>) to execute a statement that looks like this:
<br>
<br>"INSERT INTO X (A) VALUES(?)"
<br>
<br>NB: This doesn't mean you should never generate dynamic SQL statements. What it means is that you should never use user-provided data to generate those statements. Any user-provided data should be passed through as parameters to the statement after it has been prepared.
<br>
<br>So, for example, if you are building up a little framework and want to do an insert to a table based on the request URI, it's in your best interest to not take the $_SERVER['REQUEST_URI'] value (or any part of it) and directly concatenate that with your query. Instead,&nbsp; you should parse out the portion of the $_SERVER['REQUEST_URI'] value that you want, and map that through some kind of function or associative array to a non-user provided value. If the mapping produces no value, you know that something is wrong with the user provided data.
<br>
<br>Failing to follow this has been the cause of a number of SQL-injection problems in the Ruby On Rails framework, even though it uses parametric prepared statements. This is how GitHub was hacked at one point. So, no language is immune to this problem. That's why this is a general best practice and not something specific to PHP and why you should REALLY adopt it.
<br>
<br>Also, you should still do some kind of validation of the data provided by users, even when using parametric prepared statements. This is because that user-provided data will often become part of some generated HTML, and you want to ensure that the user provided data isn't going to cause security problems in the browser.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="126328">  
  <a class="name">
  <strong class="user"><em>rohankumar dot 1524 at gmail dot com</em></strong></a><div class="date" title="2021-08-11 07:26"><strong>30 days ago</strong></div>
  <div class="text" id="Hcom126328">
<div class="phpcode"><code><span class="html">
There is requirement for old projects which are using `mysql_escape_string`, and upgrading the PHP version to 7 and above. Basically this happens in maintenance projects where we don't know how many files the functions are used in application. We can use [mysqli.real-escape-string][1] for the function:<br><br>If you have a typical connection file like `conn.php`<br><br>&nbsp; &nbsp; $conn = new mysqli($host, $user, $password, $db);<br>&nbsp; &nbsp; // may be few more lines to handle the $conn<br>&nbsp; &nbsp; if (!function_exists('mysql_escape_string')) {<br>&nbsp; &nbsp; &nbsp; &nbsp; function mysql_escape_string($sting){ // if mysql_escape_string not available<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return $conn-&gt;real_escape_string($string); // escape using the $conn instance<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br><br>&nbsp; [1]: <a rel="nofollow" target="_blank">https://www.php.net/manual/en/mysqli.real-escape-string.php</a></span>
</code></div>
  </div>
 </div>
  <div class="note" id="95009">  
  <a class="name">
  <strong class="user"><em>strata_ranger at hotmail dot com</em></strong></a><div class="date" title="2009-12-08 11:17"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom95009">
<div class="phpcode"><code><span class="html">
There's an interesting quirk in the example #2 about SQL injection:&nbsp; AND takes priority over OR, so the injected query actually executes as WHERE (user='aidan' AND password='') OR ''='', so instead of returning a database record corresponding to an arbitrary username (in this case 'aidan'), it would actually return ALL database records.&nbsp; In no particular order.&nbsp; So an attacker might be able to log in as any account, but not necessarily with any control over which account it is.<br><br>Of course a potential attacker could simply modify their parameters to target specific users of interest:<br><br><span class="default">&lt;?php<br><br></span><span class="comment">// E.g. attacker's values<br></span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'username'</span><span class="keyword">] = </span><span class="string">''</span><span class="keyword">;<br></span><span class="default">$_POST</span><span class="keyword">[</span><span class="string">'password'</span><span class="keyword">] = </span><span class="string">"' OR user = 'administrator' AND '' = '"</span><span class="keyword">;<br><br></span><span class="comment">// Malformed query<br></span><span class="default">$query </span><span class="keyword">= </span><span class="string">"SELECT * FROM users WHERE user='</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">username</span><span class="keyword">]</span><span class="string">' AND password='</span><span class="default">$_POST</span><span class="keyword">[</span><span class="default">password</span><span class="keyword">]</span><span class="string">'"</span><span class="keyword">;<br><br>echo </span><span class="default">$query</span><span class="keyword">;<br><br></span><span class="comment">// The query sent to MySQL would read:<br>// SELECT * FROM users WHERE user='' AND password='' OR user='administrator' AND ''='';<br>// which would allow anyone to gain access to the account named 'administrator'<br><br></span><span class="default">?&gt;</span>
</span>
</code></div>
  </div>
 </div>
  <div class="note" id="92493">  
  <a class="name">
  <strong class="user"><em>plgs at ozemail dot com dot au</em></strong></a><div class="date" title="2009-07-27 01:05"><strong>12 years ago</strong></div>
  <div class="text" id="Hcom92493">
<div class="phpcode"><code><span class="html">
Don't forget that if you're using Mysqli (ie, the "improved" Mysql extension) then you need to use the corresponding mysqli function mysqli_real_escape_string().&nbsp; The parameter order is also different.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="120914">  
  <a class="name">
  <strong class="user"><em>jonnie</em></strong></a><div class="date" title="2017-03-31 10:53"><strong>4 years ago</strong></div>
  <div class="text" id="Hcom120914">
<div class="phpcode"><code><span class="html">
To Quote Sam at Numb Safari<br><br>[ "No discussion of escaping is complete without telling everyone that you should basically never use external input to generate interpreted code. This goes for SQL statements, or anything you would call any sort of "eval" function on.<br><br>So, instead of using this terribly broken function, use parametric prepared statements instead.<br><br>Honestly, using user provided data to compose SQL statements should be considered professional negligence and you should be held accountable by your employer or client for not using parametric prepared statements." ]<br><br>Sam is right........<br><br>However I do not think it is sensible to stop all sanitising and simply pass the task on to parametric prepared statements.<br><br>A particular developer working in a particular situation will always know more about valid input (specific to that context). <br><br>If you ask a user to pass in a value you have already given them and you know that all such values start AB****** and the string should be of length 7 or 11 but never any other length then you have the basis of a good pre-sanitiser - different allowable lengths of a string might indicate legacy data.<br><br>I would never want to simply pass the rubbish that a malicious user may have passed in through a form to the parametric prepared statements, I would always want to do my own sanity checks first and in some cases these may err on the side of caution and simply choose to abort the Database op completely. <br><br>That way my DB does not get clogged up with unsafe statements made safe - it simply does not get clogged up which is better.<br><br>Security in layers - sanitisation and validation should still be considered in every situation BEFORE using prepared statements.<br><br>In addition as far as I can read into the official doc<br>==============================================<br><br>"Escaping and SQL injection<br><br>Bound variables are sent to the server separately from the query and thus cannot interfere with it. The server uses these values directly at the point of execution, after the statement template is parsed. Bound parameters do not need to be escaped as they are never substituted into the query string directly"<br><br>That suggests to me that danger is avoided in the internals by alternative handling not by nullification.<br><br>This means that a large project with incomplete conversion to prepared statements, legacy code in different parts of an organisation or servers talking to one another could all pass on the bad news from an immune location or situation to one that is not immune.<br><br>As long as the sanitisation is competently performed without incurring additional risks then personally I would stick with certain layers of sanitisation and then call the prepared statements.</span>
</code></div>
  </div>
 </div>
  <div class="note" id="121826">  
  <a class="name">
  <strong class="user"><em>Aljo</em></strong></a><div class="date" title="2017-11-04 05:14"><strong>3 years ago</strong></div>
  <div class="text" id="Hcom121826">
<div class="phpcode"><code><span class="html">
@feedr<br>I elaborated his note as following:<br>$string = "asda\0sd\x1aas\\\\\\\\dasd\'asdasd\na\'\'sdasdad";<br>$array1 = array('\\\\\\\\', '\0', '\n', '\r', "'", '"', '\x1a');<br>$array2 = array('\\\\\\\\\\\\\\\\', '\\\0', '\\\n', '\\\r', "\\\'", '\\\"', '\\\Z');<br>echo($string);<br>echo(PHP_EOL);<br>for( $i=0; $i&lt;count($array1); $i++ ) {<br>&nbsp; &nbsp; if ($i==0)<br>&nbsp; &nbsp; $p = '/(?&lt;!\\\\)'.$array1[$i].'(?!\\\\)/';<br>&nbsp; &nbsp; else<br>&nbsp; &nbsp; $p = '/(?&lt;!\\\\)'.$array1[$i].'/';<br>&nbsp; &nbsp; echo($i);<br>&nbsp; &nbsp; echo($p);<br>&nbsp; &nbsp; echo( $array2[$i]);<br>&nbsp; &nbsp; $string = preg_replace($p, $array2[$i], $string);<br>&nbsp; &nbsp; echo("\t");<br>&nbsp; &nbsp; echo($string);<br>&nbsp; &nbsp; echo(PHP_EOL);<br>}<br>echo(PHP_EOL);<br>echo($string);</span>
</code></div>
  </div>
 </div>
  <div class="note" id="95915">  
  <a class="name">
  <strong class="user"><em>presto dot dk at gmail dot com</em></strong></a><div class="date" title="2010-01-28 07:05"><strong>11 years ago</strong></div>
  <div class="text" id="Hcom95915">
<div class="phpcode"><code><span class="html">
If you want to make sure that the ID you're using to do a query is a number, use sprint() of (int) or intval(), but don't use mysql_real_escape_string.<br><br>There is no difference between ISO-8859-1's number 10 and UTF-8's number 10.</span>
</code></div>
  </div>
 </div></div>

 
</section>    </section><!-- layout-content -->
        


  </div><!-- layout -->

  

    
 <!-- External and third party libraries. -->
 







<a id="toTop" href="javascript:;"><span id="toTopHover"></span><img width="40" height="40" alt="To Top" src="../../images/to-top%402x.png"></a>



<!-- Mirrored from www.php.net/manual/en/function.mysql-real-escape-string.php by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 11 Sep 2021 05:47:39 GMT -->

</body></html>