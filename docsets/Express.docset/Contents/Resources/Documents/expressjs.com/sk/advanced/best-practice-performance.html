<!DOCTYPE html>

<html lang="sk" prefix="og: http://ogp.me/ns#">

<!-- Mirrored from expressjs.com/sk/advanced/best-practice-performance.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 10 Jul 2019 00:23:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<title>Osvedƒçen√© postupy pre Express v produkcii - v√Ωkonnos≈• a spoƒæahlivos≈•</title>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="og:image" content="../../images/express-facebook-share.png">
<link rel="icon" type="image/png" href="../../images/favicon.png" />
<link rel="stylesheet" href="../../css/style.css">
<link rel="stylesheet" href="../../css/dropit.css">
<link rel="stylesheet" href="../../css/prism.css">
<link rel="stylesheet" href="../../css/font-awesome.min.css">
<link rel="stylesheet" href="../../../fonts.googleapis.com/css2a1d.css?family=Open+Sans:300,400,600,700&amp;amp;subset=latin,latin-ext">
<link rel="stylesheet" href="../../css/sk.css">
<link rel="stylesheet" href="../../css/nodeinteractive.css">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script data-cfasync="false" src="../../../ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script data-cfasync="false" src="../../js/ismobile.js"></script>
<script data-cfasync="false" src="../../js/app.js"></script>
<script data-cfasync="false" src="../../js/retina.js"></script>
<script data-cfasync="false" src="../../js/dropit.js"></script>
<script data-cfasync="false" src="../../js/prism.js"></script>
<link rel="stylesheet" href="../../../cdn.jsdelivr.net/npm/docsearch.js%402/dist/cdn/docsearch.min.css" />
</head>
<body class="non-en-doc">
<section class="page content">
<header>
<div id="mobile-menu">
<div id="nav-button" class="fa fa-bars fa-2x button"></div>
</div>
<section id="logo"><a href="../../index.html" class="express">Express</a>
</section>
<div id="navbar">
<input id="q" placeholder="üîé search">
<ul id="navmenu">
<li><a href="../index.html" id="home-menu">Domov</a></li>
<li>
<ul id="getting-started-menu" class="menu">
<li><a href="../starter/installing.html">Zaƒç√≠name</a>
<ul>
<li>
<a href="../starter/installing.html">
In≈°tal√°cia
</a>
</li>
<li>
<a href="../starter/hello-world.html">
Hello world
</a>
</li>
<li>
<a href="../starter/generator.html">
Express gener√°tor
</a>
</li>
<li>
<a href="../starter/basic-routing.html">
Z√°kladn√Ω routing
</a>
</li>
<li>
<a href="../starter/static-files.html">
Statick√© s√∫bory
</a>
</li>
<li>
<a href="../starter/faq.html">
FAQ
</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="guide-menu" class="menu">
<li><a href="../guide/routing.html">Pr√≠ruƒçka</a>
<ul>
<li><a href="../guide/routing.html">Routing</a>
</li>
<li><a href="../guide/writing-middleware.html">Tvorba middleware</a>
</li>
 <li><a href="../guide/using-middleware.html">Pou≈æitie middleware</a>
</li>
<li><a href="../guide/using-template-engines.html">Pou≈æitie template enginov</a>
</li>
<li><a href="../guide/error-handling.html">Error handling</a>
</li>
<li><a href="../guide/debugging.html">Debuggovanie</a>
</li>
<li><a href="../guide/behind-proxies.html">Pou≈æitie Express za proxy</a>
</li>
<li><a href="../guide/migrating-4.html">Prechod na Express 4</a>
</li>
<li><a href="../guide/migrating-5.html">Prechod na Express 5</a>
</li>
<li><a href="../guide/database-integration.html">Integr√°cia s datab√°zou</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="application-menu" class="menu">
<li><a href="../4x/api.html">API referenƒçn√° pr√≠ruƒçka</a>
<ul>
<li><a href="../4x/api.html">4.x</a>
</li>
<li><a href="../3x/api.html">3.x (zastaral√©)</a>
</li>
<li><a href="../../2x/index.html">2.x (zastaral√©)</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="advanced-topics-menu" class="menu">
<li><a href="developing-template-engines.html" class="active">Pokroƒçil√© t√©my</a>
<ul>
<li><a href="developing-template-engines.html">Templatovacie enginy</a>
</li>
<li><a href="pm.html">Pou≈æitie spr√°vcov procesov</a>
</li>
<li><a href="security-updates.html">Security - aktualiz√°cie</a>
</li>
<li><a href="best-practice-security.html">Security - osvedƒçen√© postupy</a>
</li>
<li><a href="best-practice-performance.html">V√Ωkonnos≈• - osvedƒçen√© postupy</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<ul id="resources-menu" class="menu">
<li><a href="../resources/glossary.html">Zdroje</a>
<ul>
<li><a href="../resources/glossary.html">Glos√°r</a>
</li>
<li><a href="../resources/middleware.html">Middleware</a>
</li>
<li><a href="../resources/community.html">Komunita</a>
</li>
<li><a href="../resources/frameworks.html">Frameworky</a>
</li>
<li><a href="../resources/books-blogs.html">Knihy a blogy</a>
</li>
<li><a href="../resources/companies-using-express.html">Firmy pou≈æ√≠vaj√∫ce Express</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</header>
<div id="overlay"></div>
<div id="i18n-notice-box" class="doc-box doc-warn">
<p>Tento dokument m√¥≈æe by≈• v porovnan√≠ s dokument√°ciou v angliƒçtine zastaral√Ω. Aktu√°lne inform√°cie n√°jdete v <a href="../../index.html">dokument√°cii v angliƒçtine</a>.
</p>
<div id="close-i18n-notice-box" title="Close">‚úñ</div>
</div>
<div id="page-doc" markdown="1">

<h1 id="osvedƒçen√©-postupy-pre-express-v-produkcii-v√Ωkonnos≈•-a-spoƒæahlivos≈•">Osvedƒçen√© postupy pre Express v produkcii: v√Ωkonnos≈• a spoƒæahlivos≈•</h1>
<h2 id="prehƒæad">Prehƒæad</h2>
<p>Tento ƒçl√°nok popisuje niektor√© osvedƒçen√© postupy z pohƒæadu v√Ωkonnosti a spoƒæahlivosti Express aplik√°ci√≠ v produkcii.</p>
<p>T√°to ƒças≈• jasne spad√° do tzv. ‚Äúdevops‚Äù sveta, dot√Ωkaj√∫ca sa tradiƒçn√©ho v√Ωvoja a prev√°dzky. Podƒæa toho s√∫ tieto inform√°cie rozdelen√© do dvoch ƒçast√≠:</p>
<ul>
<li><a href="#code">Kroky, ktor√© je potrebn√© vykona≈• vo va≈°om k√≥de</a> (ƒças≈• v√Ωvoja).</li>
<li><a href="#env">Kroky, ktor√© je potrebn√© vykona≈• na va≈°om prostred√≠</a> (ƒças≈• prev√°dzky).</li>
</ul>
<p><a name="code"></a></p>
<h2 id="kroky-ktor√©-je-potrebn√©-vykona≈•-vo-va≈°om-k√≥de">Kroky, ktor√© je potrebn√© vykona≈• vo va≈°om k√≥de</h2>
<p>Dodr≈æiavanie nasleduj√∫cich postupov vo va≈°om k√≥de m√¥≈æe vies≈• k zlep≈°eniu v√Ωkonnosti va≈°ej aplik√°cie:</p>
<ul>
<li>Pou≈æ√≠vajte gzip kompresiu</li>
<li>Nepou≈æ√≠vajte synchr√≥nne funkcie</li>
<li>Pre servovanie statick√Ωch s√∫borov pou≈æ√≠vajte middleware</li>
<li>Spr√°vne logujte</li>
<li>Spr√°vne odchyt√°vajte a spracov√°vajte v√Ωnimky</li>
</ul>
<h3 id="pou≈æ√≠vajte-gzip-kompresiu">Pou≈æ√≠vajte gzip kompresiu</h3>
<p>Pou≈æitie gzip kompresie m√¥≈æe veƒæmi zn√≠≈æi≈• veƒækos≈• response body a t√Ωm zv√Ω≈°√≠≈• r√Ωchlos≈• webovej aplik√°cie. Pre zapnutie gzip kompresie vo va≈°ej Express aplik√°cii pou≈æ√≠vajte <a href="https://www.npmjs.com/package/compression">compression</a> middleware. Napr.:</p>
<pre><code class="language-javascript" translate="no">
var compression = require('compression');
var express = require('express');
var app = express();
app.use(compression());
</code>
</pre>
<p>Pre str√°nky s vysokou n√°v≈°tevnos≈•ou sa odpor√∫ƒça implementova≈• kompresiu na √∫rovni reverse proxy (pozrite sa na <a href="#proxy">Pou≈æitie reverse proxy</a>). V takom pr√≠pade nemus√≠te pou≈æi≈• compression middleware. Pre viac detailov ohƒæadom zapnutia gzip kompresie na Nginx serveri sa pozrite na <a href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html">Module ngx_http_gzip_module</a> v Nginx dokument√°cii.</p>
<h3 id="nepou≈æ√≠vajte-synchr√≥nne-funkcie">Nepou≈æ√≠vajte synchr√≥nne funkcie</h3>
<p>Synchr√≥nne funkcie a met√≥dy ‚Äúdr≈æia‚Äù proces vykonania a≈æ do k√Ωm nebud√∫ spracovan√©. Jedno volanie synchr√≥nnej funkcie m√¥≈æe trva≈• p√°r mikrosek√∫nd, ƒçi milisek√∫nd, av≈°ak v pr√≠pade str√°nok s vysokou n√°v≈°tevnos≈•ou, tak√©to volania zni≈æuj√∫ v√Ωkonnos≈• aplik√°cie. Preto sa ich pou≈æ√≠vaniu v produkcii vyhnite.</p>
<p>Hoci samotn√Ω Node i mnoh√© jeho moduly poskytuj√∫ synchr√≥nne a asynchr√≥nne verzie ich funkci√≠, v produkcii v≈ædy pou≈æ√≠vajte ich asynchr√≥nne verzie. Jedin√° situ√°cia, kedy by malo pou≈æitie synchr√≥nnej funkcie opodstatnenie, je pri prvotnom spusten√≠ aplik√°cie.</p>
<p>Ak pou≈æ√≠vate Node.js 4.0+ alebo io.js 2.1.0+, m√¥≈æete pou≈æi≈• prep√≠naƒç <code>--trace-sync-io</code>, ktor√Ω vyp√≠≈°e warning a stack trace v≈ædy, keƒè va≈°a aplik√°cia pou≈æije synchr√≥nne API. V produkcii to samozrejme nepou≈æ√≠vajte, ale u≈æ pri developmente sa uistite, ≈æe va≈°a aplik√°cia je pripraven√° na produkciu. Pre viac inform√°ci√≠ sa pozrite na <a href="https://nodejs.org/en/blog/weekly-updates/weekly-update.2015-05-22/#2-1-0">Weekly update for io.js 2.1.0</a>.</p>
<h3 id="pre-servovanie-statick√Ωch-s√∫borov-pou≈æ√≠vajte-middleware">Pre servovanie statick√Ωch s√∫borov pou≈æ√≠vajte middleware</h3>
<p>V developmente m√¥≈æete pre servovanie statick√Ωch s√∫borov pou≈æ√≠va≈• <a href="../4x/api.html#res.sendFile">res.sendFile()</a>. V produkcii to v≈°ak nepou≈æ√≠vajte, preto≈æe t√°to funkcia mus√≠ pri ka≈ædom requeste ƒç√≠ta≈• d√°ta z file syst√©mu, ƒço m√° za n√°sledok znaƒçn√© oneskorenie a celkovo nepriaznivo ovlyv≈àuje v√Ωkonnos≈• aplik√°cie. <code>res.sendFile()</code> funkcia <em>nie</em> je implementovan√° pomocou <a href="http://linux.die.net/man/2/sendfile">sendfile</a> syst√©mov√©ho volania, ktor√© by ju robilo oveƒæa efekt√≠vnej≈°ou.</p>
<p>Namiesto toho pou≈æ√≠vajte <a href="https://www.npmjs.com/package/serve-static">serve-static</a> middleware (pr√≠padne podobn√Ω ekvivalent), ktor√Ω je optimalizovan√Ω pre servovanie statick√Ωch s√∫borov v Express aplik√°ci√°ch.</p>
<p>E≈°te lep≈°ou mo≈ænos≈•ou pre servovanie statick√Ωch s√∫borov je pou≈æitie reverse proxy; pre viac inform√°ci√≠ sa pozrite na <a href="#proxy">Pou≈æitie reverse proxy</a>.</p>
<h3 id="spr√°vne-logujte">Spr√°vne logujte</h3>
<p>Vo v≈°eobecnosti existuj√∫ dva d√¥vody k logovaniu vo va≈°ej aplk√°cii a to debugovanie a logovanie aktiv√≠t va≈°ej aplik√°cie. Pou≈æitie <code>console.log()</code> pr√≠p. <code>console.err()</code> k vyp√≠saniu log spr√°vy je be≈ænou praxou poƒças developmentu. Av≈°ak pozor, <a href="https://nodejs.org/api/console.html#console_console_1">tieto funkcie s√∫ synchr√≥nne</a> v pr√≠pade, ak je v√Ωstupom termin√°l pr√≠p. s√∫bor, tak≈æe nie s√∫ vhodn√© pre produkƒçn√© prostredie, pokiaƒæ v√Ωstup nepresmerujete do in√©ho programu.</p>
<h4 id="logovanie-z-d√¥vodu-debugovania">Logovanie z d√¥vodu debugovania</h4>
<p>Ak pou≈æ√≠vate na debugovanie logovanie pomocou <code>console.log()</code>, pou≈æ√≠vajte rad≈°ej ≈°peci√°lny modul na debugovanie, ako napr. <a href="https://www.npmjs.com/package/debug">debug</a>. Tento modul v√°m umo≈æ≈àuje pou≈æiva≈• environment premenn√∫ DEBUG, pomocou ktorej dok√°≈æete kontrolova≈•, ktor√© debug v√Ωpisy bud√∫ vyp√≠san√© pomocou <code>console.err()</code>, pr√≠p. ≈æiadne. Ak chcete, aby va≈°a aplik√°cia bola ƒçisto asynchr√≥nna, budete st√°le potrebova≈• presmerova≈• v√Ωstup <code>console.err()</code> do in√©ho programu. Ale v skutoƒçnosti asi nechcete debugova≈• v produkcii, v≈°ak?</p>
<h4 id="logovanie-aktiv√≠t-aplik√°cie">Logovanie aktiv√≠t aplik√°cie</h4>
<p>Ak pou≈æ√≠vate logovanie na sledovanie aktiv√≠t aplik√°cie (napr. sledovanie traffic-u, pr√≠p. API volan√≠), pou≈æ√≠vajte namiesto <code>console.log()</code> logovacie kni≈ænice, ako s√∫ napr. <a href="https://www.npmjs.com/package/winston">Winston</a> ƒçi <a href="https://www.npmjs.com/package/bunyan">Bunyan</a>. Ak v√°s zauj√≠ma detailnej≈°ie porovnanie t√Ωchto dvoch kni≈æn√≠c, preƒç√≠tajte si tento blog post: <a href="https://strongloop.com/strongblog/compare-node-js-logging-winston-bunyan/">Comparing Winston and Bunyan Node.js Logging</a>.</p>
<p><a name="exceptions"></a></p>
<h3 id="spr√°vne-odchyt√°vajte-a-spracov√°vajte-v√Ωnimky">Spr√°vne odchyt√°vajte a spracov√°vajte v√Ωnimky</h3>
<p>V pr√≠pade neodchytenia v√Ωnimky Node.js aplik√°cia spadne. Tzn, ≈æe v pr√≠pade nespracovania v√Ωnimky a nevykonania spr√°vnej akcie va≈°a Express aplik√°cia spadne. Ak budete pokraƒçova≈• podƒæa r√°d v ƒçasti <a href="#restart">Zabe≈æpeƒçte, aby sa va≈°a aplik√°cia automaticky re≈°tartovala</a>, tak sa va≈°a aplik√°cia z p√°du zotav√≠. Express aplik√°cie potrebuj√∫ na≈°tastie len kr√°tky ƒças k na≈°tartovaniu. Bez ohƒæadu nato, by ste sa mali p√°dom aplik√°cie v prvom rade vyhn√∫≈• a k tomu potrebujete spr√°vne odchyt√°va≈• v√Ωnimky.</p>
<p>K uisteniu sa, ≈æe spracov√°vate v≈°etky v√Ωnimky, pou≈æ√≠vajte tieto techniky:</p>
<ul>
<li><a href="#try-catch">Pou≈æ√≠vajte try-catch</a></li>
<li><a href="#promises">Pou≈æ√≠vajte promises</a></li>
</ul>
<p>Predt√Ωm, ako sa hlb≈°ie pust√≠me do t√Ωchto t√©m, mali by ste ma≈• z√°kladn√© znalosti Node/Express error handlingu, ak√Ωmi s√∫ pou≈æ√≠vanie error-first callback-ov a ≈°√≠renie errorov middlewarmi. Node pou≈æ√≠va pre n√°vrat errorov z asynchr√≥nnych funkci√≠ konvenciu ‚Äúerror-first callbackov‚Äù, kde prv√Ωm argumentom callback funkcie je error objekt, nasledovan√Ω ostatn√Ωmi n√°vratov√Ωmi hodnotami √∫spe≈°n√©ho spracovanie funkcie. Ak nenastal ≈æiaden error zabezpeƒçte, aby prv√Ωm parametrom bol null. Defin√≠cia callback funkcie mus√≠ kore≈°pondova≈• s error-first callback konvenciou a mus√≠ zmysluplne spracova≈• error. V Express aplik√°ci√°ch je pre ≈°√≠renie erroru middlewarmi osvedƒçenou a odpor√∫ƒçanou technikou pou≈æitie next() funkcie.</p>
<p>Pre viac inform√°ci√≠ ohƒæadom z√°kladov error handlingu sa pozrite na:</p>
<ul>
<li><a href="https://www.joyent.com/developers/node/design/errors">Error Handling in Node.js</a></li>
<li><a href="https://strongloop.com/strongblog/robust-node-applications-error-handling/">Building Robust Node Applications: Error Handling</a> (StrongLoop blog)</li>
</ul>
<h4 id="ƒço-nerobi≈•">ƒåo nerobi≈•</h4>
<p>Jedna z vec√≠, ktor√∫ by ste robi≈• <em>nemali</em> je poƒç√∫va≈• na <code>uncaughtException</code> event, ktor√Ω je emitovan√Ω v okamihu kedy v√Ωnimka ‚Äúbubl√°‚Äù celou cestu sp√§≈• do event loop-u. Pridanie event listenera <code>uncaughtException</code> zmen√≠ defaultn√© chovanie procesu, ktor√Ω narazil na v√Ωnimku; proces bude pokraƒçova≈• napriek v√Ωnimke. Toto sa m√¥≈æe zda≈• ako dobr√Ωm rie≈°en√≠m, ako pred√≠s≈• p√°du va≈°ej aplik√°cie, av≈°ak pokraƒçovanie behu va≈°ej aplik√°cie, v pr√≠pade neodchytenej v√Ωnimky je nebezpeƒçnou praktikou a nepodpor√∫ƒça sa, preto≈æe sa t√Ωm stav procesu st√°va nespoƒæahliv√Ωm a nepredpovedateƒæn√Ωm.</p>
<p>Navy≈°e, pou≈æitie <code>uncaughtException</code> je ofici√°lne uznan√© ako <a href="https://nodejs.org/api/process.html#process_event_uncaughtexception">hrub√©</a> a existuje <a href="https://github.com/nodejs/node-v0.x-archive/issues/2582">n√°vrh</a> na jeho odstr√°nenie z jadra. Tak≈æe poƒç√∫vanie na <code>uncaughtException</code> nie je dobr√Ωm n√°padom. To je d√¥vod, preƒço odpor√∫ƒçame veci ako viacero procesov a supervisorov: p√°d a re≈°tartovanie je ƒçasto najspolalivej≈°√≠m sp√¥sobom zotavenia sa z erorru.</p>
<p>Taktie≈æ neodpor√∫ƒçame pou≈æ√≠va≈• <a href="https://nodejs.org/api/domain.html">domain</a> modul. V≈°eobecne nerie≈°i ≈æiaden probl√©m a je oznaƒçen√Ω ako deprecated modul.</p>
<p><a name="try-catch"></a></p>
<h4 id="pou≈æ√≠vajte-try-catch">Pou≈æ√≠vajte try-catch</h4>
<p>Try-catch je klasick√° kon≈°trukcia v jazyku JavaScript, pomocou ktorej dok√°≈æete odchyti≈• v√Ωnimky v synchr√≥nnom k√≥de. Pou≈æite try-catch, napr. na spracovanie ch√Ωb pri JSON parsingu, ako na uk√°≈æke ni≈æ≈°ie.</p>
<p>Pou≈æ√≠vajte n√°stroje <a href="http://jshint.com/">JSHint</a> pr√≠p. <a href="http://www.jslint.com/">JSLint</a>, ktor√© v√°m pom√¥≈æu n√°js≈• implicitn√© v√Ωnimky, ako napr. <a href="http://www.jshint.com/docs/options/#undef">reference errors on undefined variables</a>.</p>
<p>Tu je pr√≠klad pou≈æitia try-catch k odchyteniu potenci√°lnej v√Ωnimky zapr√≠ƒçi≈àuj√∫cej p√°d procesu.
T√°to middleware funkcia pr√≠jma query parameter nazvan√Ω ‚Äúparams‚Äù ktor√Ω je JSON objekt.</p>
<pre><code class="language-javascript" translate="no">
app.get('/search', function (req, res) {
  // Simulating async operation
  setImmediate(function () {
    var jsonStr = req.query.params;
    try {
      var jsonObj = JSON.parse(jsonStr);
      res.send('Success');
    } catch (e) {
      res.status(400).send('Invalid JSON string');
    }
  });
});
</code>
</pre>
<p>Pozor, try-catch funguje len pre synchr√≥nny k√≥d. Vzhƒæadom nato, ≈æe Node platforma je prim√°rne asynchr√≥nna (obzvl√°≈°≈• v produkƒçnom prostred√≠), veƒæa v√Ωnimiek try-catch neodchyt√≠.</p>
<p><a name="promises"></a></p>
<h4 id="pou≈æ√≠vajte-promises">Pou≈æ√≠vajte promises</h4>
<p>Promises dok√°≈æu spracova≈• v≈°etky typy v√Ωnimiek (explicitn√© aj implicitn√©) v asynchr√≥nnych blokoch k√≥du pou≈æ√≠vajuce <code>then()</code>, pridan√≠m <code>.catch(next)</code> na koniec promise re≈•azca. Napr.:</p>
<pre><code class="language-javascript" translate="no">
app.get('/', function (req, res, next) {
  // do some sync stuff
  queryDb()
    .then(function (data) {
      // handle data
      return makeCsv(data);
    })
    .then(function (csv) {
      // handle csv
    })
    .catch(next);
});

app.use(function (err, req, res, next) {
  // handle error
});
</code>
</pre>
<p>Takto sa v≈°etky asynchr√≥nne i synchr√≥nne errory pre≈°√≠ria do error middleware-u.</p>
<p>Av≈°ak, dve upozornenia:</p>
<ol>
<li>V≈°etky va≈°e asynchr√≥nne k√≥dy musia vraca≈• promises (okrem emitorov). Ak niektor√° z kni≈æn√≠c nevracia promises, konvertnite z√°kladn√Ω objekt pou≈æit√≠m funkcie ako napr. <a href="http://bluebirdjs.com/docs/api/promise.promisifyall.html">Bluebird.promisifyAll()</a>.</li>
<li>Event emitory (ako s√∫ streams) m√¥≈æu sp√¥sobi≈• neodchyten√© v√Ωnimky. Preto sa uistite, ≈æe spr√°vne spracov√°vate error eventy.
Napr.:</li>
</ol>
<pre><code class="language-javascript" translate="no">
app.get('/', wrap(async (req, res, next) =&gt; {
  let company = await getCompanyById(req.query.id);
  let stream = getLogoStreamById(company.id);
  stream.on('error', next).pipe(res);
}));
</code>
</pre>
<p>Pre viac inform√°ci√≠ ohƒæadom error handling-u pou≈æit√≠m promises si preƒç√≠tajte:</p>
<ul>
<li><a href="https://strongloop.com/strongblog/async-error-handling-expressjs-es7-promises-generators/">Asynchronous Error Handling in Express with Promises, Generators and ES7</a></li>
<li><a href="https://strongloop.com/strongblog/promises-in-node-js-with-q-an-alternative-to-callbacks/">Promises in Node.js with Q ‚Äì An Alternative to Callbacks</a></li>
</ul>
<p><a name="env"></a></p>
<h2 id="kroky-ktor√©-je-potrebn√©-vykona≈•-na-va≈°om-prostred√≠">Kroky, ktor√© je potrebn√© vykona≈• na va≈°om prostred√≠</h2>
<p>Tu je niekoƒæko krokov, ktor√© m√¥≈æete vykona≈• na va≈°om environment-e pre zlep≈°enie v√Ωkonnosti va≈°ej aplik√°cie:</p>
<ul>
<li>Nastavte NODE_ENV premenn√∫ na ‚Äúproduction‚Äù</li>
<li>Zabezpeƒçte automatick√Ω re≈°tart va≈°ej aplik√°cie</li>
<li>Zabezpeƒçte, aby va≈°a aplik√°cia be≈æala v clusteri</li>
<li>Cachujte request resulty</li>
<li>Pou≈æ√≠vajte load balancer</li>
<li>Pou≈æ√≠vajte reverse proxy</li>
</ul>
<h3 id="nastavte-node_env-premenn√∫-na-production">Nastavte NODE_ENV premenn√∫ na ‚Äúproduction‚Äù</h3>
<p>NODE_ENV environment premenn√° ≈°pecifikuje, v ktorom environmente va≈°a aplik√°cia be≈æ√≠, zvyƒçajne (development alebo production). Jedna z najjednoduch≈°√≠ch vec√≠, ktor√∫ m√¥≈æete vykona≈• k zlep≈°eniu v√Ωkonnosti va≈°ej aplik√°cie je nastavenie premennej NODE_ENV na ‚Äúproduction‚Äù.</p>
<p>Nastavenie NODE_ENV na ‚Äúproduction‚Äù zabezpeƒç√≠, aby Express:</p>
<ul>
<li>Cachoval view templates.</li>
<li>Cachoval CSS s√∫bory generovan√© z CSS extenzi√≠.</li>
<li>Generoval ‚Äúmenej ukecan√©‚Äù error messages.</li>
</ul>
<p><a href="http://apmblog.dynatrace.com/2015/07/22/the-drastic-effects-of-omitting-node_env-in-your-express-js-applications/">Testy ukazuj√∫</a>, ≈æe tym dok√°≈æete zlep≈°i≈• v√Ωkonnos≈• aplik√°cie a≈æ trojn√°sobne!</p>
<p>Ak potrebujete p√≠sa≈• k√≥d, ktor√Ω je environment-specific, m√¥≈æete hodnotu NODE_ENV premennej zisti≈• pomocou <code>process.env.NODE_ENV</code>. Pam√§tajte v≈°ak nato, ≈æe zis≈•ovanie hodnoty akejkoƒævek environment premennej m√° ƒçiastoƒçn√Ω dopad na v√Ωkonnos≈•, preto by ste to mali robi≈• sk√¥r sporadicky.</p>
<p>Poƒças v√Ωvoja nastavujete environment premenn√© zvyƒçajne pomocou shellu, napr. pou≈æit√≠m <code>export</code> vo va≈°om <code>.bash_profile</code> s√∫bore. Toto by ste v≈°ak nemali robi≈• na produkƒçnom serveri; namiesto toho, pou≈æite init syst√©m v√°≈°ho operaƒçn√©ho syst√©mu (systemd alebo Upstart). Nasleduj√∫ca sekcia poskytuje viac detailov ohƒæadom pou≈æitia init syst√©mu, priƒçom nastavenie NODE_ENV premennej je veƒæmi d√¥le≈æit√© z pohƒæadu v√Ωkonnosti (a z√°rove≈à veƒæmi jednoduch√©), ako je naƒçrtnut√© tu:</p>
<p>Pomocou Upstart, pou≈æite kƒæ√∫ƒçov√© slovo <code>env</code> vo va≈°om job s√∫bore. Napr.:</p>
<pre><code class="language-sh" translate="no">
# /etc/init/env.conf
 env NODE_ENV=production
</code>
</pre>
<p>Pre viac inform√°ci√≠ si preƒç√≠tajte <a href="http://upstart.ubuntu.com/cookbook/#environment-variables">Upstart Intro, Cookbook and Best Practices</a>.</p>
<p>Pomocou systemd, pou≈æite direkt√≠vu <code>Environment</code> vo va≈°om unit s√∫bore. Napr.:</p>
<pre><code class="language-sh" translate="no">
# /etc/systemd/system/myservice.service
Environment=NODE_ENV=production
</code>
</pre>
<p>Pre viac inform√°ci√≠ si preƒç√≠tajte <a href="https://coreos.com/os/docs/latest/using-environment-variables-in-systemd-units.html">Using Environment Variables In systemd Units</a>.</p>
<p>Ak pou≈æ√≠vate StrongLoop Process Manager, m√¥≈æete <a href="https://docs.strongloop.com/display/SLC/Setting+up+a+production+host#Settingupaproductionhost-Setenvironmentvariables">nastavi≈• environment premenn√∫ taktie≈æ keƒè nain≈°talujete StrongLoop PM ako slu≈æbu</a>.</p>
<h3 id="zabe≈æpeƒçte-aby-sa-va≈°a-aplik√°cia-automaticky-re≈°tartovala">Zabe≈æpeƒçte, aby sa va≈°a aplik√°cia automaticky re≈°tartovala</h3>
<p>V produkcii zvyƒçajne nechcete, aby va≈°a aplik√°cia bola offline, nikdy. To znamen√°, ≈æe mus√≠te zabezpeƒçi≈•, aby sa re≈°tartovala v obidvoch pr√≠padoch, ƒçi u≈æ je to p√°d aplik√°cie, alebo servera samotn√©ho. Hoci si urƒçite ≈æel√°te, aby sa ani jedna z t√Ωchto vec√≠ nestala, mus√≠te s t√Ωm poƒç√≠ta≈• pomocou:</p>
<ul>
<li>Pou≈æit√≠m spr√°vcu procesov k re≈°tartovaniu aplik√°cie (a Node procesu) v pr√≠pade p√°du.</li>
<li>Pou≈æit√≠m init syst√©mu poskytovan√©ho va≈°im OS na re≈°tartovanie spr√°vcu procesov v pr√≠pade p√°du OS. Taktie≈æ je mo≈æn√© pou≈æi≈• init syst√©m bez spr√°vcu procesov.</li>
</ul>
<p>Node aplik√°cie zhavaruj√∫ v pr√≠pade v√Ωskytu neodchytenej v√Ωnimky. Ako prv√© by ste sa mali uisti≈•, ≈æe va≈°a aplik√°cia je dostatoƒçne otestovan√° a spracov√°va v≈°etky v√Ωnimky (pre viac detailov si pozrite ƒças≈• <a href="#exceptions">Spr√°vne odchyt√°vajte a spracov√°vajte v√Ωnimky</a>). Ako z√°chranu vytvorte/nastavte mechanizmus automatick√©ho re≈°tartu.</p>
<h4 id="pou≈æ√≠vajte-spr√°vcu-procesov">Pou≈æ√≠vajte spr√°vcu procesov</h4>
<p>Poƒças v√Ωvoja ≈°tartujete va≈°u aplik√°ciu jednoducho z pr√≠kazov√©ho riadka pomocou <code>node server.js</code>, pr√≠p. nieƒçoho podobn√©ho. Tento sp√¥sob je v≈°ak v pr√≠pade produkcie cesta do pekla. Ak va≈°a aplik√°cia spadne, bude offline a≈æ dok√Ωm ju nere≈°tartujete. Aby ste sa uistili, ≈æe sa va≈°a aplik√°cia v pr√≠pade p√°du re≈°tartuje, pou≈æ√≠vajte spr√°vcu procesov. Spr√°vca procesov je ‚Äúkontainer‚Äù pre aplik√°cie, ktor√Ω v√°m pom√°ha pri deploymente, poskytuje vysok√∫ dostupnos≈• a umo≈æ≈àuje spr√°vu aplik√°cie v runtime.</p>
<p>Spr√°vca procesov umo≈æ≈àuje okrem automatick√©ho re≈°tartu va≈°ej aplik√°cie taktie≈æ:</p>
<ul>
<li>Z√≠ska≈• pohƒæad o v√Ωkonnosti runtime a spotrebe resourcov.</li>
<li>Dynamicky upravova≈• nastavenia pre zlep≈°enie v√Ωkonnosti.</li>
<li>Kontrolu clusteringu (StrongLoop PM a pm2).</li>
</ul>
<p>Spomedzi spr√°vcov procesov pre Node s√∫ najpopul√°rnej≈°i:</p>
<ul>
<li><a href="http://strong-pm.io/">StrongLoop Process Manager</a></li>
<li><a href="https://github.com/Unitech/pm2">PM2</a></li>
<li><a href="https://www.npmjs.com/package/forever">Forever</a></li>
</ul>
<p>Pre detailnej≈°ie porovnanie vlastnost√≠ si pozrite <a href="http://strong-pm.io/compare/">http://strong-pm.io/compare/</a>. Pre detailnej≈°ie intro si pozrite <a href="pm.html">Process managers for Express apps</a>.</p>
<p>Pou≈æit√≠m hociktor√©ho z t√Ωchto spr√°vcov procesov zabezpeƒç√≠te, aby va≈°a aplik√°cia zostala ‚Äúhore‚Äù i v pr√≠pade obƒçasn√©ho p√°du.</p>
<p>Av≈°ak, StrongLoop PM m√° veƒæa ƒèal≈°√≠ch features ≈°peci√°lne urƒçen√© pre produkƒçn√© prostredie. M√¥≈æete ich pou≈æi≈• na:</p>
<ul>
<li>Vytvorenie buildu va≈°ej aplik√°cie lok√°lne a n√°sledn√Ω bezpeƒçn√Ω deployment do produkcie.</li>
<li>Automatick√Ω re≈°tart va≈°ej aplik√°cie v pr√≠pade p√°du.</li>
<li>Vzdialen√∫ spr√°vu v√°≈°ho clustera.</li>
<li>Zobrazenie CPU profilov a heap snapshotov k optimaliz√°cii v√Ωkonnosti a diagnostike memory leakov.</li>
<li>Zabrazenie performance metr√≠k va≈°ej aplik√°cie.</li>
<li>Jednoduch√∫ ≈°k√°lovateƒænos≈• na viacero hostov s intergrovanou kontrolou pre Nginx load balancer.</li>
</ul>
<p>Ako je vysvetlen√© ni≈æ≈°ie, pri in≈°tal√°cii StrongLoop PM pomocou init syst√©mu, ako slu≈æby operaƒçn√©ho syst√©mu, sa slu≈æba automaticky re≈°tartuje po re≈°tartovan√≠ syst√©mu. Takto bude va≈°a aplik√°cia a cluster be≈æa≈• nav≈ædy.</p>
<h4 id="pou≈æ√≠vajte-init-syst√©m">Pou≈æ√≠vajte init syst√©m</h4>
<p>ƒéal≈°iou vrstvou spoƒæahlivosti je zabezpeƒçenie, aby sa va≈°a aplik√°cia re≈°tartovala pri re≈°tartovan√≠ servera. Syst√©my m√¥≈æu spadn√∫≈• z r√¥znych d√¥vodov. Aby bolo zaisten√©, aby sa va≈°a aplik√°cie re≈°tartovala v pr√≠pade, ak d√¥jde k chybe servera, pou≈æite init syst√©m zabudovan√Ω do v√°≈°ho operaƒçn√©ho syst√©mu. Dva hlavn√© init syst√©my pou≈æ√≠van√© v s√∫ƒçasnosti s√∫ <a href="https://wiki.debian.org/systemd">systemd</a> a <a href="http://upstart.ubuntu.com/">Upstart</a>.</p>
<p>Existuj√∫ dva sp√¥soby pou≈æitia init syst√©mov s va≈°ou Express aplik√°ciou:</p>
<ul>
<li>Spustite va≈°u aplik√°ciu v spr√°vcovi procesov a nain≈°talujte spr√°vcu procesov ako slu≈æbu s init syst√©mom. Spr√°vca procesov zabezpeƒç√≠ re≈°tart aplik√°cie pri jej p√°de a init syst√©m re≈°tartuje spr√°vcu procesov v pr√≠pade re≈°tartu OS. Jedn√° sa o odpor√∫ƒçan√Ω postup.</li>
<li>Spustite va≈°u aplik√°ciu (a Node) priamo s init syst√©mom. Tento postup je trocha jednoduch≈°√≠, ale pr√≠dete t√Ωm o ƒèal≈°ie v√Ωhody plyn√∫ce z pou≈æitia spr√°vcu procesov.</li>
</ul>
<h5 id="systemd">Systemd</h5>
<p>Systemd je spr√°vca slu≈æieb pou≈æ√≠van√Ω niektor√Ωmi distrib√∫ciami Linuxu. V√§ƒç≈°ina hlavn√Ωch linuxov√Ωch distrib√∫ci√≠ prijala systemd ako svoj defaultn√Ω init syst√©m.</p>
<p>Konfiguraƒçn√Ω s√∫bor pre systemd sa naz√Ωva <em>unit file</em>, ktor√©ho n√°zov m√° pr√≠ponu .service. Tu je pr√≠klad s√∫boru pre priamu spr√°vu Node aplik√°cie (nahradte tuƒçn√Ω text s hodnotami v√°≈°ho syst√©me a aplik√°cie):</p>
<pre><code class="language-sh" translate="no">
[Unit]
Description=Awesome Express App

[Service]
Type=simple
ExecStart=/usr/local/bin/node /projects/myapp/index.js
WorkingDirectory=/projects/myapp

User=nobody
Group=nogroup

# Environment variables:
Environment=NODE_ENV=production

# Allow many incoming connections
LimitNOFILE=infinity

# Allow core dumps for debugging
LimitCORE=infinity

StandardInput=null
StandardOutput=syslog
StandardError=syslog
Restart=always

[Install]
WantedBy=multi-user.target
</code>
</pre>
<p>Pre viac inform√°ci√≠ ohƒæadom systemd si preƒç√≠tajte <a href="http://www.freedesktop.org/software/systemd/man/systemd.unit.html">systemd reference (man page)</a>.</p>
<h5 id="strongloop-pm-ako-systemd-slu≈æba">StrongLoop PM ako systemd slu≈æba</h5>
<p>StrongLoop PM mo≈æete jednoducho nain≈°talova≈• ako systemd slu≈æbu. N√°sledne, v pr√≠pade ≈æe nastane re≈°tart servera, systemd automaticky re≈°tartuje i StrongLoop PM, ktor√Ω n√°sledne re≈°tartuje i aplik√°cie ktor√© spravuje.</p>
<p>Pre in≈°tal√°ciu StrongLoop PM ako systemd slu≈æby spustite:</p>
<pre><code class="language-sh" translate="no">
$ sudo sl-pm-install --systemd
</code>
</pre>
<p>Potom spustite slu≈æbu pomocou:</p>
<pre><code class="language-sh" translate="no">
$ sudo /usr/bin/systemctl start strong-pm
</code>
</pre>
<p>Pre viac inform√°ci√≠ si preƒç√≠tajte <a href="https://docs.strongloop.com/display/SLC/Setting+up+a+production+host#Settingupaproductionhost-RHEL7+,Ubuntu15.04or15.10">Setting up a production host (StrongLoop documentation)</a>.</p>
<h5 id="upstart">Upstart</h5>
<p>Upstart je syst√©mov√Ω n√°stroj dostupn√Ω v mnoh√Ωch linuxov√Ωch distrib√∫ci√°ch sl√∫≈æiaci na sp√∫≈°≈•anie taskov a slu≈æieb poƒças ≈°tartu syst√©mu, ich zastavenie poƒças vypnutia a dohƒæadu nad nimi. Va≈°u Express aplik√°ciu, alebo spr√°vcu procesov m√¥≈æete nakonfigurova≈• ako slu≈æbu a potom Upstart zabezpeƒç√≠ jej re≈°tart v pr√≠pade p√°du.</p>
<p>Upstart slu≈æba je definovan√° v konfiguraƒçnom s√∫bore (tie≈æ naz√Ωvan√Ω ‚Äújob‚Äù) s n√°zvom s√∫boru konƒçiacim <code>.conf</code>. Nasleduj√∫ci pr√≠klad ukazuje, ako vytvori≈• job s√∫bor s n√°zvom ‚Äúmyapp‚Äù pre aplik√°ciu s n√°zvom ‚Äúmyapp‚Äù s hlavn√Ωm s√∫bor umiestnen√Ωm v <code>/projects/myapp/index.js</code>.</p>
<p>Vytvorte s√∫bor s n√°zvom <code>myapp.conf</code> umiestnen√Ω v <code>/etc/init /</code> s nasleduj√∫cim obsahom (nahraƒète tuƒçn√Ω text s hodnotami pre v√°≈° syst√©m a aplik√°ciu):</p>
<pre><code class="language-sh" translate="no">
# When to start the process
start on runlevel [2345]

# When to stop the process
stop on runlevel [016]

# Increase file descriptor limit to be able to handle more requests
limit nofile 50000 50000

# Use production mode
env NODE_ENV=production

# Run as www-data
setuid www-data
setgid www-data

# Run from inside the app dir
chdir /projects/myapp

# The process to start
exec /usr/local/bin/node /projects/myapp/index.js

# Restart the process if it is down
respawn

# Limit restart attempt to 10 times within 10 seconds
respawn limit 10 10
</code>
</pre>
<p>Pozn.: Tento skript vy≈æaduje Upstart 1.4 pr√≠p. nov≈°√≠, podporovan√Ω na Ubuntu 12.04-14.10.</p>
<p>Potom, ako je job nakonfigurovan√Ω k spusteniu po ≈°tarte syst√©mu, bude va≈°a aplik√°cia spusten√° spolu s operaƒçn√Ωm syst√©mom a automaticky re≈°tartovan√° v pr√≠pade p√°du aplik√°cie alebo re≈°tartu samotn√©ho syst√©mu.</p>
<p>Okrem automatick√©ho re≈°tartovania aplik√°cie, Upstart umo≈æ≈àuje pou≈æ√≠≈• tieto pr√≠kazy:</p>
<ul>
<li><code>start myapp</code> ‚Äì Start the app</li>
<li><code>restart myapp</code> ‚Äì Restart the app</li>
<li><code>stop myapp</code> ‚Äì Stop the app.</li>
</ul>
<p>Pre viac inform√°ci√≠ ohƒæadom Upstart si preƒç√≠tajte tu: <a href="http://upstart.ubuntu.com/cookbook">Upstart Intro, Cookbook and Best Practises</a>.</p>
<h5 id="strongloop-pm-ako-upstart-slu≈æba">StrongLoop PM ako Upstart slu≈æba</h5>
<p>StrongLoop PM mo≈æete jednoducho nain≈°talova≈• ako Upstart slu≈æbu. N√°sledne, v pr√≠pade ≈æe nastane re≈°tart servra, Upstart automaticky re≈°tartuje i StrongLoop PM, ktor√Ω n√°sledne re≈°tartuje aj aplik√°cie ktor√© spravuje.</p>
<p>Pre in≈°tal√°ciu StrongLoop PM ako Upstart 1.4 slu≈æby:</p>
<pre><code class="language-sh" translate="no">
$ sudo sl-pm-install
</code>
</pre>
<p>Pre spustenie slu≈æby:</p>
<pre><code class="language-sh" translate="no">
$ sudo /sbin/initctl start strong-pm
</code>
</pre>
<p>Pozn.: Pre syst√©my bez podpory Upstart 1.4 s√∫ pr√≠kazy mierne odli≈°n√©. Pre viac inform√°ci√≠ sa pozrite na <a href="https://docs.strongloop.com/display/SLC/Setting+up+a+production+host#Settingupaproductionhost-RHELLinux5and6,Ubuntu10.04-.10,11.04-.10">Setting up a production host (StrongLoop documentation)</a>.</p>
<h3 id="zabezpeƒçte-aby-va≈°a-aplik√°cia-be≈æala-v-clusteri">Zabezpeƒçte aby va≈°a aplik√°cia be≈æala v clusteri</h3>
<p>V pr√≠pade multi-core syst√©mov m√¥≈æete zv√Ω≈°i≈• v√Ωkonnos≈• Node aplik√°cie niekoƒæko n√°sobne jej spusten√≠m clusterom procesov. V clusteri be≈æ√≠ niekoƒæko in≈°tanci√≠ aplik√°cie, ide√°lne jedna pre ka≈æd√© CPU jadro, ƒç√≠m sa rozlo≈æ√≠ z√°≈•a≈æ a √∫lohy medzi jednotl√≠v√© in≈°tancie.</p>
<p><img src="../../images/clustering.png" alt="Balancovanie medzi in≈°tanciami aplik√°cie pou≈æit√≠m cluster API" /></p>
<p>D√¥le≈æit√©: Od momentu kedy in≈°tancia aplik√°cie be≈æ√≠ ako samostatn√Ω proces, nezdieƒæaj√∫ spoloƒçnu pam√§≈•. Tzn. objekty s√∫ lok√°lne pre ka≈æd√∫ in≈°tanciu aplik√°cie. Preto nedok√°≈æete spravova≈• stav v k√≥de aplik√°cie. Namiesto toho m√¥≈æete k ukladaniu d√°t t√Ωkaj√∫cich sa session a stavu pou≈æi≈• tzv. in-memory datastore ako <a href="http://redis.io/">Redis</a>. Toto varovanie plat√≠ v podstate pre v≈°etky formy horizont√°lneho ≈°k√°lovania, ƒçi u≈æ clustering s viacer√Ωmi procesmi alebo viacero fyzick√Ωch servrov.</p>
<p>V clusterovan√Ωch aplik√°ci√°ch, worker procesy m√¥≈æu spadn√∫≈• individu√°lne bez toho, aby ovplyvnili zvy≈°ok procesov. Okrem v√Ωhody z pohƒæadu v√Ωkonnosti, izolovanie chybovosti je ƒèal≈°√≠m d√¥vodom pre beh clustra procesov aplik√°cie. V pr√≠pade, ≈æe worker proces spadne zabezpeƒçte, ≈æe v≈ædy sa zalogujte event a vytvor√≠ nov√Ω process (spawn) pomocou cluster.fork().</p>
<h4 id="pou≈æite-node-cluster-modulu">Pou≈æite Node cluster modulu</h4>
<p>Clustering je mo≈æn√Ω pomocou Node <a href="https://nodejs.org/dist/latest-v4.x/docs/api/cluster.html">cluster modulu</a>. Ten dovoƒæuje master procesu vyrobi≈• (spawn) worker procesy a rozdistribuova≈• prich√°dzaj√∫ce spojenia medzi workerov. Av≈°ak, lep≈°ie ne≈æ priame pou≈æitie tohto modulu je pou≈æi≈• jeden z mnoh√Ωch existuj√∫cich toolov, ktor√© to robia automaticky, napr. <a href="https://www.npmjs.com/package/node-pm">node-pm</a> alebo <a href="https://www.npmjs.com/package/cluster-service">cluster-service</a>.</p>
<h4 id="pou≈æitie-strongloop-pm">Pou≈æitie StrongLoop PM</h4>
<p>V pr√≠pade, ≈æe deploynete va≈°u aplik√°ciu do StrongLoop Process Manager (PM), z√≠skate t√Ωm v√Ωhody clusteringu <em>bez</em> modifik√°cie k√≥du va≈°ej aplik√°cie.</p>
<p>Keƒè StrongLoop Process Manager (PM) sp√∫≈°ta aplik√°ciu, aplik√°cia je spusten√° automaticky v clusteri s tak√Ωm mno≈æstvom workerov, a√Ω je poƒçet jadier CPU syst√©me. Poƒçet worker procesov v clustri m√¥≈æete manu√°lne zmeni≈• pou≈æit√≠m slc n√°stroja bez nutnosti stopnutia aplik√°cie.</p>
<p>Napr., predpokladaj√∫c, ≈æe ste deployli va≈°u aplik√°ciu na prod.foo.com a StrongLoop PM poƒç√∫va na porte 8701 (defaultn√Ω), tak nastavenie veƒækosti clustera na osem vykon√°te pomocou slc takto:</p>
<pre><code class="language-sh" translate="no">
$ slc ctl -C http://prod.foo.com:8701 set-size my-app 8
</code>
</pre>
<p>Pre viac inform√°ci√≠ ohƒæadom clusteringu pomocou StrongLoop PM sa pozrite na ƒças≈• <a href="https://docs.strongloop.com/display/SLC/Clustering">Clustering</a> v StrongLoop dokument√°cii.</p>
<h3 id="cache-ovanie-odpoved√≠-requestov">Cache-ovanie odpoved√≠ requestov</h3>
<p>ƒéal≈°ou strat√©giou pre zlep≈°enie v√Ωkonosti v produkcii je cachovanie odpoved√≠ na prich√°dzaj√∫ce requesty, ƒç√≠m zabezpeƒç√≠te, ≈æe va≈°a aplik√°cia nemus√≠ opakovane vykon√°vat tie ist√© oper√°cie pre obsl√∫≈æenie rovnak√Ωch requestov.</p>
<p>Pou≈æitie caching servra, ako [Varnish] (https://www.varnish-cache.org/) alebo <a href="https://www.nginx.com/resources/wiki/start/topics/examples/reverseproxycachingexample/">Nginx</a> (pozrite si tie≈æ <a href="https://serversforhackers.com/nginx-caching/">Nginx Caching</a>) v√Ωrazne zv√Ω≈°i r√Ωchlos≈• a v√Ωkon v√°≈°ej aplik√°cie.</p>
<h3 id="pou≈æitie-load-balancera">Pou≈æitie load balancera</h3>
<p>Bez ohƒæadu na to, ako je optimalizovan√° aplik√°cia, jedna in≈°tancia m√¥≈æe spracova≈• iba obmedzen√© mno≈æstvo z√°≈•a≈æe a requestov. Jedn√Ωm sp√¥sobom ≈°k√°lovania aplik√°cie je spustenei jej viacer√Ωch in≈°tanci√≠ a distribuova≈• za≈•a≈æenie pomocou load balancera. Zapojenie load balancera m√¥≈æe zlep≈°i≈• v√Ωkon a r√Ωchlos≈• va≈°ej aplik√°cie a umo≈æn√≠ jej vaƒç≈°ie ≈°k√°lovanie, ne≈æ by bolo mo≈æn√© v pr√≠pade jedinej in≈°tancie.</p>
<p>Load balancer je zvyƒçajne reverzn√© proxy, ktor√© organizuje prev√°dzku medzi viacer√Ωmi in≈°tanciami aplik√°cie a serverov. Load balancer m√¥≈æete pre va≈°u aplik√°ciu setupn√∫≈• jednoducho pou≈æ√≠t√≠m <a href="http://nginx.org/en/docs/http/load_balancing.html">Nginx</a>, alebo <a href="https://www.digitalocean.com/community/tutorials/an-introduction-to-haproxy-and-load-balancing-concepts">HAProxy</a>.</p>
<p>Load balancer zabezpeƒç√≠ spr√°vne sp√°rovanie requestov s√∫visiacich s konkr√©tnym session ID a procesom, ktor√Ω t√∫to session spravuje. Tento pr√≠stup sa naz√Ωva <em>session affinity</em>, alebo <em>sticky sessions</em> a m√¥≈æe by≈• rie≈°en√Ω n√°vrhom pop√≠san√Ωm vy≈°≈°ie, teda pou≈æit√≠m d√°tov√©ho √∫lo≈æiska ako je Redis (v z√°vislosti od aplik√°cie). Preƒç√≠tajte si nasleduj√∫cu diskusiu <a href="http://socket.io/docs/using-multiple-nodes/">Using multiple nodes</a>.</p>
<h4 id="pou≈æitie-strongloop-pm-spolu-s-nginx-load-balancerom">Pou≈æitie StrongLoop PM spolu s Nginx load balancerom</h4>
<p><a href="http://strong-pm.io/">StrongLoop Process Manager</a> je integrovan√Ω s Nginx Controller-om, ƒço uƒæahƒçuje konfigur√°ciu multi-host produkƒçn√©ho prostredia. Pre viac inform√°ci√≠ sa pozrite na <a href="https://docs.strongloop.com/display/SLC/Scaling+to+multiple+servers">Scaling to multiple servers</a> (StrongLoop dokument√°cia).
<a name="proxy"></a></p>
<h3 id="pou≈æitie-reverzn√©ho-proxy">Pou≈æitie reverzn√©ho proxy</h3>
<p>Reverzn√© proxy je umiestnen√© pred webovou aplik√°ciou a vykon√°va podporn√© oper√°cie k requestom smerovan√Ωch na aplik√°ciu. Medzi inn√Ωm, dok√°≈æe handlova≈• str√°nky s errormi, kompresiu, caching, servovanie s√∫borov a load balancing.</p>
<p>Odovzdanie √∫loh, ktor√© nevy≈æaduj√∫ znalos≈• stavu aplik√°cie reverzn√©mu proxy, odbremen√≠ Express aplik√°ciu a umo≈æn√≠ jej vykon√°va≈• ≈°pecializovan√© √∫lohy. Z tohto d√¥vodu sa v produkcii odpor√∫ƒça fungovanie Express za reverzn√Ωm proxy ako je <a href="https://www.nginx.com/">Nginx</a> ƒçi <a href="http://www.haproxy.org/">HAProxy</a>.</p>
</div>
</section>
<noscript>
    <iframe src="http://www.googletagmanager.com/ns.html?id=GTM-5XL76H" height="0" width="0" style="display: none; visibility: hidden;"></iframe>
</noscript>
<script type="86b75c58135e1e1bcc86567e-text/javascript">
(function(w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
    });
    var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
        '../../../www.googletagmanager.com/gtm5445.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
})(window, document, 'script', 'dataLayer', 'GTM-5XL76H');
</script>
<a id="top" href="#"><img src="../../images/arrow.png"></a>
<footer>
<div id="footer-content">
<div id="github">
<iframe src="https://ghbtns.com/github-btn.html?user=expressjs&amp;repo=express&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="200px" height="20px"></iframe>
</div>
<div id="sponsor">
<a href="https://github.com/expressjs/express/">Express</a> je projekt patriaci pod <a href="http://nodejs.org/foundation"></a>Node.js Foundation</a>.
</div>
<div id="fork">
<a href="https://github.com/expressjs/expressjs.com">Editova≈• str√°nku na GitHub-e</a>.
</div>
<div>Copyright &copy; 2016 StrongLoop, IBM a ostatn√≠ expressjs.com prispievatelia.</div>
</div>
<div id="license">
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/"><img alt="Creative Commons License" style="border-width:0" src="../../../i.creativecommons.org/l/by-sa/3.0/us/80x15.png" /></a> This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-ShareAlike 3.0 United States License</a>.
</div>
</footer>
<script type="86b75c58135e1e1bcc86567e-text/javascript" src="../../../cdn.jsdelivr.net/npm/docsearch.js%402/dist/cdn/docsearch.min.js" onload="docsearch({
  apiKey: '7164e33055faa6ecddefd9e08fc59f5d',
  indexName: 'expressjs',
  inputSelector: '#q',
  algoliaOptions: { 'facetFilters': ['lang:sk'] }
})" async></script>
<script src="../../../ajax.cloudflare.com/cdn-cgi/scripts/a2bd7673/cloudflare-static/rocket-loader.min.js" data-cf-settings="86b75c58135e1e1bcc86567e-|49" defer=""></script></body>

<!-- Mirrored from expressjs.com/sk/advanced/best-practice-performance.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 10 Jul 2019 00:23:55 GMT -->
</html>
